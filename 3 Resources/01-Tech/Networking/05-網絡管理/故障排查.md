---
title: 故障排查
aliases:
  - Network Troubleshooting
  - 网络故障排查
para: resource
tags:
  - #para/resource/tech
  - #topic/networking
  - #topic/troubleshooting
  - #type/guide
  - #zettel/type/permanent
created: 2026-02-15
---

> [!summary] 故障排查概述
> 網絡故障排查是系統化地識別、診斷和解決網絡問題的過程，基於OSI七層模型分層排查。

---

## 📋 目錄

- [分層排查法](#分層排查法)
- [常見故障案例](#常見故障案例)
- [排查工具使用](#排查工具使用)
- [應急響應流程](#應急響應流程)
- [故障排查Checklist](#故障排查checklist)

---

## 🔍 分層排查法

### 故障排查金字塔

```
                    7. 應用程式層
                       │
              ┌──────────┴──────────┐
              │ 6. 表示層 & 會話層  │
              └──────────┬──────────┘
                         │
              ┌──────────┴──────────┐
              │ 5. 傳輸層         │
              └──────────┬──────────┘
                         │
              ┌──────────┴──────────┐
              │ 4. 網路層         │
              └──────────┬──────────┘
                         │
              ┌──────────┴──────────┐
              │ 3. 數據鏈路層      │
              └──────────┬──────────┘
                         │
              ┌──────────┴──────────┐
              │ 2. 物理層         │
              └───────────────────────┘
```

### 每層檢查清單

#### 7. 應用程式層
- [ ] 應用程式是否正常運行
- [ ] 檢查應用程式日誌
- [ ] 測試應用程式功能
- [ ] 檢查服務端口是否開放

#### 6. 表示層 & 會話層
- [ ] 數據格式是否正確
- [ ] 加密/解密是否正常
- [ ] 會話狀態是否正常

#### 5. 傳輸層
- [ ] 端口是否監聽
- [ ] 防火牆是否阻止連接
- [ ] TCP/UDP連接狀態
- [ ] 網絡連接數是否正常

#### 4. 網路層
- [ ] IP地址配置是否正確
- [ ] 路由表是否正確
- [ ] ARP表是否正確
- [ ] ICMP (ping) 是否通

#### 3. 數據鏈路層
- [ ] MAC地址是否正確
- [ ] 交換機端口狀態
- [ ] VLAN配置是否正確
- [ ] 帧錯誤統計

#### 2. 物理層
- [ ] 網卡是否識別
- [ ] 驅動程序是否安裝
- [ ] 網線是否連接
- [ ] 光纖/雙絞線狀態
- [ ] 速率/雙工模式設置

---

## 🎯 常見故障案例

### 案例1：無法訪問網際網

**症狀**：所有設備都無法上網

**排查步驟**：
```
1. 物理層檢查
   ├─ 網線是否連接
   ├─ 網卡燈是否亮起
   └─ 驅動程序是否正常

2. 數據鏈路層檢查
   ├─ 交換機端口是否UP
   ├─ MAC地址學習是否正常
   └─ 端口錯誤統計

3. 網路層檢查
   ├─ IP地址是否正確
   ├─ 路由表是否正確
   ├─ 網關是否可達 (ping)
   └─ DNS是否正常 (nslookup)

4. 傳輸層檢查
   ├─ 防火牆是否阻止
   ├─ 端口是否開放
   └─ 代理設置

5. 應用程式層檢查
   ├─ 瀏覽器設置
   ├─ 應用程式配置
   └─ 服務狀態
```

### 案例2：網速慢

**症狀**：可以上網但速度很慢

**排查步驟**：
```
1. 確定慢速範圍
   ├─ 僅局域網慢？
   ├─ 所有網站都慢？
   └─ 特定網站慢？

2. 局域網慢
   ├─ 檢查交換機端口流量
   ├─ 檢查是否有廣播風暴
   ├─ 檢查網絡拓撲
   └─ 使用iperf測試帶寬

3. 網際網慢
   ├─ 測試不同網站
   ├─ 測試ISP速度
   ├─ traceroute檢查路由
   └─ 使用MTR檢查每跳延遲

4. 無線網絡慢
   ├─ 檢查信號強度
   ├─ 檢查信道干擾
   ├─ 檢查連接模式
   └─ 使用Wi-Fi分析器
```

### 案例3：部分設備無法連接

**症狀**：某些設備無法連接網絡

**排查步驟**：
```
1. 檢查共同點
   ├─ 交換機
   ├─ 無線接入點
   └─ 網關

2. 檢查問題設備
   ├─ IP地址是否正確
   ├─ 子網掩碼是否正確
   ├─ 網關是否正確
   ├─ DNS是否正確
   ├─ MAC地址過濾
   └─ 設備是否被禁用

3. 檢查VLAN配置
   ├─ VLAN ID是否正確
   ├─ Trunk端口是否正確
   ├─ DHCP是否正常工作
   └─ 是否有足夠IP地址
```

---

## 🛠️ 排查工具使用

### 層次1-2（物理/數據鏈路層）

```bash
# 查看網卡信息
ifconfig
ip addr show
ethtool eth0

# 查看交換機端口
show interface status
show interface counters
show mac address-table
```

### 層次3（網路層）

```bash
# IP連通性測試
ping target_ip
ping -c 4 target_ip
ping -s 1024 target_ip

# 路由追蹤
traceroute target_ip
tracert target_ip

# 路由表
route -n
ip route show

# ARP表
arp -a
arp -n
```

### 層次4（傳輸層）

```bash
# 端口狀態
netstat -an
ss -tuln

# TCP連接追蹤
tcpdump -i eth0 host target_ip

# Wireshark抓包分析
# 抓取特定端口
tcpdump -i eth0 port 80 -w capture.pcap
```

### 層次5-7（會話/表示/應用程式層）

```bash
# DNS查詢
nslookup domain
dig domain
dig +trace domain

# 服務連接測試
telnet host port
nc -zv host port

# HTTP測試
curl -I http://target
curl -v https://target

# SSL證書檢查
openssl s_client -connect target:443
```

### 綜合工具

| 工具 | 用途 | 優點 |
|------|------|------|
| Wireshark | 圖形化包分析 | 協議詳細分析 |
| tcpdump | 命令行抓包 | 服務器使用 |
| Nmap | 端口掃描、服務識別 | 快速掃描 |
| iperf | 帶寬測試 | 網絡性能測試 |
| MTR | 網絡診斷 | 結合ping+traceroute |

---

## 🚨 應急響應流程

### 故障分級

| 等級 | 影響範圍 | 響應時間 | 處理人 |
|------|----------|----------|--------|
| P1 | 全服務中斷 | <15分鐘 | L2/值班工程師 |
| P2 | 主要服務受影響 | <30分鐘 | L2/L3工程師 |
| P3 | 部分服務受影響 | <2小時 | L3工程師 |
| P4 | 輕微影響 | <4小時 | L3工程師 |

### 應急響應步驟

```
1. 接收告警
   └─ 評估影響範圍和優先級

2. 初步診斷
   ├─ 收集基礎資訊
   ├─ 使用監控工具確認
   └─ 初步定位問題範圍

3. 啟動響應團隊
   ├─ 通知相關人員
   ├─ 分配任務
   └─ 開始排查

4. 問題修復
   ├─ 實施修復方案
   ├─ 驗證修復效果
   └─ 監控系統穩定性

5. 復驗和恢復
   ├─ 確認服務恢復
   ├─ 根本原因分析
   ├─ 更新文檔和知識庫
   └─ 預防措施
```

---

## 📋 故障排查Checklist

### 網絡無法連接

- [ ] 檢查網線連接
- [ ] 檢查網卡燈/指示
- [ ] 重啟網卡/交換機
- [ ] 檢查IP配置
- [ ] Ping網關
- [ ] 檢查DNS
- [ ] 檢查防火牆

### 網速慢

- [ ] 確定慢速範圍
- [ ] 檢查帶寬使用情況
- [ ] 檢查網絡拓撲
- [ ] 檢查網絡設備負載
- [ ] 檢查干擾
- [ ] 使用測速工具驗證

### 特定網站無法訪問

- [ ] 測試其他網站
- [ ] 測試其他設備
- [ ] 檢查DNS
- [ ] 清除DNS緩存
- [ ] 檢查hosts文件
- [ ] 檢查代理/VPN設置

---

## 📝 學習檢查清單

- [ ] 掌握基於OSI模型的分層排查法
- [ ] 了解每層的檢查清單和工具
- [ ] 掌握常見故障案例的排查步驟
- [ ] 能夠熟練使用網絡診斷工具
- [ ] 了解應急響應的流程和分級
- [ ] 能夠使用故障排查Checklist

---

## 🔗 相關連結

- 🔙 [[05-網絡管理|返回網絡管理]]
- 🛠️ [[網絡診斷工具]]
- 📊 [[網絡效能優化]]
- 🔍 [[問題排查模板]]
