---
title: 網路監控
aliases:
  - Network Monitoring
  - 監控
  - SNMP
  - 网络监控
para: resource
tags:
  - #para/resource/tech
  - #topic/networking
  - #topic/network-monitoring
  - #protocol/snmp
  - #type/guide
  - #zettel/type/permanent
created: 2026-01-21
---

> [!summary] 網路監控概述
> 網路監控是指实时監控網路狀態，及时發現和解決網路問題，确保網路正常運行。

---

## 🎯 監控目標

### 为什么需要監控

1. **故障检测**：及时發現網路故障
2. **效能優化**：识别效能瓶颈
3. **容量規劃**：预测資源需求
4. **安全审计**：检测异常流量和攻击
5. **服务品質**：确保SLA达标

### 監控指标

| 类别 | 指标 |
|------|------|
| **可用性** | 设备線上率、服务可用率 |
| **效能** | 延遲、吞吐量、丢包率、抖动 |
| **資源** | CPU使用率、記憶體使用率、带宽利用率 |
| **错误** | 错误率、超时数、重传数 |
| **安全** | 异常流量、入侵检测 |

---

## 📊 SNMP协议

### 定义

SNMP (Simple Network Management Protocol) 是一種應用層協議，用於監控和管理網路設備。

### 版本

| 版本 | 說明 |
|------|------|
| SNMPv1 | 原始版本，安全性較低 |
| SNMPv2c | 改進版，支持批量操作 |
| SNMPv3 | 增強安全（認證和加密） |

### 組件

```
┌─────────────────────────────────────────────────────┐
│                                                     │
│              NMS (Network Management System)         │
│           (Network Management Station)                │
│                                                     │
└───────────────────────┬─────────────────────────────┘
                        │ SNMP (Get/Set/Trap)
        ┌───────────────┼───────────────┐
        │               │               │
   ┌────┴────┐    ┌────┴────┐    ┌────┴────┐
   │ 路由器   │    │ 交换机   │    │ 伺服器   │
   │(Agent)  │    │(Agent)  │    │(Agent)  │
   └─────────┘    └─────────┘    └─────────┘
```

### OID (Object Identifier)

OID是SNMP中用於標識管理對象的層次結構名稱。

### SNMP操作

| 操作 | 說明 | 方向 |
|------|------|------|
| GET | 获取单个OID | NMS → Agent |
| GET-NEXT | 获取下一个OID | NMS → Agent |
| GET-BULK | 批量获取多個OID | NMS → Agent |
| SET | 設置OID值 | NMS → Agent |
| TRAP | 主动發送通知 | Agent → NMS |
| INFORM | 確認的TRAP | Agent ↔ NMS |

### OID樹狀結構

```
iso (1)
 └─ org (3)
    └─ dod (6)
       └─ internet (1)
          ├─ private (4)
          │  └─ enterprises (1)
          │     └─ cisco (9)
          │        └─ ...
          └─ mgmt (2)
             └─ mib-2 (1)
                ├─ system (1)
                ├─ interfaces (2)
                ├─ ip (4)
                └─ tcp (6)
```

### 常用OID

| OID | 說明 |
|------|------|
| .1.3.6.1.2.1.1.1.0 | 系統描述 |
| .1.3.6.1.2.1.1.5.0 | 系統名称 |
| .1.3.6.1.2.1.1.3.0 | 系統運行時間 |
| .1.3.6.1.2.1.2.2.1.10 | 接口輸入字节数 |
| .1.3.6.1.2.1.2.2.1.16 | 接口輸出字节数 |

---

## 🛠️ 監控工具

### 命令行工具

```bash
# snmpwalk - 获取多個OID
snmpwalk -v2c -c public 192.168.1.1 .1.3.6.1.2.1.1

# snmpget - 获取单个OID
snmpget -v2c -c public 192.168.1.1 .1.3.6.1.2.1.1.5.0

# snmpset - 設置OID值
snmpset -v2c -c private 192.168.1.1 .1.3.6.1.2.1.1.5.0 s "Router1"
```

### 開源監控平台

#### Nagios

**特點**：
- 成熟稳定
- 外掛豐富
- 社區活跃

**監控內容**：
- 主机存活
- 服务可用性
- 資源使用率

#### Zabbix

**特點**：
- Web界面友好
- 支持自動發現
- 分布式監控
- 内置绘图

**監控內容**：
- 網路设备
- 伺服器
- 應用程式服务
- 自定义指标

#### Prometheus + Grafana

**特點**：
- 时序資料庫
- 灵活的查詢语言
- 强大的可视化
- 适合雲端原生環境

**架構**：
```
Exporter → Prometheus → Grafana
```

---

## 📈 監控指标详解

### 1. 可用性監控

**指标**：
- 设備線上率
- 服務可用率
- 響應時間

**監控方式**：
- Ping監控
- 端口監控
- HTTP監控

**阈值設置**：
```
可用性 ≥ 99.9% (每月停机 < 43分钟)
可用性 ≥ 99.99% (每年停机 < 53分钟)
可用性 ≥ 99.999% (每年停机 < 5分钟)
```

### 2. 效能監控

**延遲 (Latency)**
- 定义：數據从源到目的地的時間
- 测量：Ping, traceroute
- 阈值：< 100ms (優秀), < 200ms (良好), > 500ms (差)

**吞吐量 (Throughput)**
- 定义：单位時間内傳輸的數據量
- 测量：iperf, iperf3
- 单位：bps, Mbps, Gbps

**丢包率 (Packet Loss)**
- 定义：遺失的數據包比例
- 阈值：< 1% (優秀), < 5% (良好), > 10% (差)

**抖动 (Jitter)**
- 定义：延遲的变化程度
- 影响：语音/視訊品質
- 阈值：< 30ms (優秀), < 50ms (良好), > 100ms (差)

### 3. 資源監控

**CPU使用率**
```
正常：< 70%
警告：70-90%
严重：> 90%
```

**記憶體使用率**
```
正常：< 80%
警告：80-90%
严重：> 90%
```

**带宽利用率**
```
正常：< 50%
警告：50-80%
严重：> 80%
```

### 4. 接口監控

**接口狀態**
```
UP：正常運行
DOWN：接口關閉
ADMIN_DOWN：管理員關閉
```

**接口流量**
- 輸入/輸出速率
- 輸入/輸出字节数
- 错误統計

---

## 🔔 告警機制

### 告警级别

| 级别 | 颜色 | 說明 | 通知方式 |
|------|------|------|----------|
| Information | 蓝色 | 資訊通知 | 日志 |
| Warning | 黄色 | 警告 | 電子郵件 |
| Error | 橙色 | 错误 | 電子郵件+簡訊 |
| Critical | 红色 | 严重 | 電子郵件+簡訊+電話 |

### 告警流程

```
監控指标采集
    ↓
阈值檢查
    ↓
是否超过阈值？
    ├─ 否 → 繼續
    └─ 是 → 触发告警
        ↓
    發送通知
        ↓
    確認告警
        ↓
    問題處理
        ↓
    告警恢復
```

### 告警抑制

避免告警风暴，避免重复告警：
- 時間視窗内相同告警只發送一次
- 依赖告警（上游故障时抑制下游告警）
- 告警聚合

---

## 📊 監控报表

### 常见报表

1. **可用性报表**：每日/每周/每月可用性統計
2. **效能报表**：延遲、吞吐量趨勢
3. **故障报表**：故障次数、故障时长、MTBF、MTTR
4. **容量报表**：資源使用趨勢，预测扩容時間
5. **告警报表**：告警統計、響應時間

---

## 🎯 監控最佳實踐

### 1. 監控分层

```
业务层 → 應用程式层 → 系統层 → 網路层 → 基礎设施层
```

### 2. 設置合理阈值

- 基于歷史數據
- 考虑业务需求
- 分级告警

### 3. 及时處理告警

- 建立告警響應流程
- 指定责任人
- 記錄處理過程

### 4. 定期審查監控

- 審查監控覆盖率
- 调整阈值
- 優化監控策略

### 5. 自動化

- 自動發現設備
- 自動化部署監控
- 自動化告警響應

---

## 📝 學習檢查清單

- [ ] 了解SNMP协议的基本原理
- [ ] 知道常用的SNMP操作
- [ ] 掌握常用的監控工具
- [ ] 了解監控指标和阈值設置
- [ ] 理解告警機制和流程
- [ ] 知道監控最佳實踐

---

## 🔗 相關連結

- 🔙 [[05-網絡管理|返回網絡管理]]
- 🔧 [[故障排查]]
- 📊 [[網路效能優化]]
- 🛠️ [[網絡診斷工具]]
