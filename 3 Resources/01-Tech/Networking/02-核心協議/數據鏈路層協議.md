---
title: 數據鏈路層協議
aliases:
  - Data Link Layer Protocols
  - 數據鏈路層協議
para: resource
tags:
  - #para/resource/tech
  - #topic/networking
  - #topic/protocols
  - #layer/data-link
  - #protocol/ethernet
  - #type/concept
  - #zettel/type/permanent
  - #difficulty/intermediate
  - #learning/mastered
created: 2026-02-15
updated: 2026-02-15
---

> [!summary] 數據鏈路層協議概述
> 數據鏈路層協議負責在相鄰節點之間提供可靠的數據傳輸，主要協議包括Ethernet、VLAN、STP等。

---

## 📋 目錄

- [Ethernet](#ethernet)
- [MAC地址](#mac地址)
- [VLAN](#vlan)
- [STP生成樹協議](#stp生成樹協議)
- [PPP協議](#ppp協議)

---

## 🔌 Ethernet (以太網)

### 定義

Ethernet 是最廣泛使用的局域網技術，基於CSMA/CD（載波聽聽多路訪問/衝突檢測）。

### Ethernet標準

| 標準 | 速度 | 介質 | 最大距離 |
|-------|------|------|----------|
| 10Base5 | 10 Mbps | 粗同軸電纜 | 500m |
| 10Base2 | 10 Mbps | 細同軸電纜 | 185m |
| 10BaseT | 10 Mbps | 雙絞線 (Cat3) | 100m |
| 100BaseT | 100 Mbps | 雙絞線 (Cat5) | 100m |
| 1000BaseT | 1 Gbps | 雙絞線 (Cat5e) | 100m |
| 10GBaseT | 10 Gbps | 雙絞線 (Cat6a) | 100m |
| 1000BaseSX | 1 Gbps | 光纖 (多模) | 550m |
| 1000BaseLX | 1 Gbps | 光纖 (單模) | 5km |

### Ethernet幀格式

```
┌────────────────────────────────────────────────────────┐
│ 前導碼 (8)          │ 目標MAC (48) │ 源MAC (48)      │
├─────────────────────────────────────────────────────┤
│ 類型/長度 (16) │ 數據 (46-1500)          │
├─────────────────────────────────────────────────────┤
│ CRC (32)                                   │
└─────────────────────────────────────────────────────┘
```

**幀長度**：
- 最小：64字節（含前導）
- 最大：1518字節（含前導）
- MTU (Maximum Transmission Unit)：1500字節

### MAC地址

**格式**：XX:XX:XX:XX:XX:XX

**結構**：
- 前3字節（OUI）：廠商識別碼
- 後3字節：序列號

**類型**：
- 單播：01:00:5E:00:00:00 (NAT保留)
- 組播：01:00:5E:00:00:01 - 01:00:5E:7F:FF:FF:FF
- 廣播：FF:FF:FF:FF:FF:FF:FF

---

## 🏷️ VLAN (Virtual Local Area Network)

### 定義

VLAN 是將一個物理LAN劃分成多個邏輯LAN的技術。

### VLAN類型

| 類型 | 說明 | 優勢 |
|------|------|------|
| 基於端口 | 將端口分配到VLAN | 配置簡單 |
| 基於MAC | 根據MAC地址分配 | 靈活，設備移動不受影響 |
| 基於協議 | 根據協議類型分配 | 不需人工配置 |
| 基於子網 | 根據IP子網分配 | 與IP路由集成 |

### VLAN標籤

**802.1Q標籤**：在幀頭中添加4字節的VLAN標籤。

```
VLAN標籤格式：
TPID (16) | TCI (16)
其中TCI包含：
- Priority (3 bits)
- CFI (1 bit)
- VLAN ID (12 bits)
```

### Trunk vs Access

| 類型 | 說明 | 端口 |
|------|------|------|
| Access | 只屬於一個VLAN | 連接終端設備 |
| Trunk | 可承載多個VLAN | 連接交換機之間或路由器 |

### VLAN配置示例

```bash
# Cisco IOS配置
vlan 10
 name Sales

vlan 20
 name Engineering

interface fastethernet 0/1
 switchport mode access
 switchport access vlan 10

interface fastethernet 0/24
 switchport mode trunk
 switchport trunk allowed vlan 10,20
```

---

## 🌳 STP生成樹協議

### 定義

STP (Spanning Tree Protocol) 是用於防止二層網路環路的協議。

### STP端口狀態

```
Blocking (阻斷) → Listening (監聽) → Learning (學習) → Forwarding (轉發)
     ↑                                                            ↓
     └──────────────────────────────────────────────────────────┘
```

| 狀態 | 說明 |
|------|------|
| Blocking | 不轉發數據，只接收BPDU |
| Listening | 接收BPDU，不轉發用戶數據 |
| Learning | 學習MAC地址，不轉發用戶數據 |
| Forwarding | 正常轉發數據 |
| Disabled | 管理關閉 |

### STP變體

| 版本 | 說明 | 收斂時間 |
|------|------|----------|
| STP (802.1D) | 傳統STP | 50秒 |
| RSTP (802.1w) | 快速STP | 數秒 |
| MSTP (802.1s) | 多生成樹 | 數秒 |
| Rapid PVST+ | Cisco私有協議 | 數秒 |

### BPDU (Bridge Protocol Data Unit)

**BPDU類型**：
1. **Configuration BPDU**：用於選舉根橋
2. **TCN BPDU**：拓補變化通知

### STP選舉過程

```
1. 選舉根橋 (Root Bridge)
   - 最小Bridge ID (Bridge Priority + MAC)
   - 最小Root Path Cost

2. 選舉根端口 (Root Port)
   - 到根橋路徑成本最小的端口

3. 選舉指定端口 (Designated Port)
   - 每個網段的指定端口
   - 阻斷其他端口
```

---

## 🔗 PPP協議

### 定義

PPP (Point-to-Point Protocol) 是用於點到點連接的數據鏈路層協議。

### PPP特點

| 特點 | 說明 |
|------|------|
| 錯誤檢測 | CRC校驗 |
| 身份認證 | PAP, CHAP |
| 壓縮 | 支持數據壓縮 |
| 加密 | 支持數據加密 |

### PPP建立過程

```
1. 鏈路建立 (LCP)
2. 認證
3. 網絡層協議配置 (NCP)
4. 數據傳輸
5. 鏈路終止
```

### PPP vs HDLC

| 特性 | PPP | HDLC |
|------|-----|------|
| 標準化 | 是 | 否（Cisco私有） |
| 支持協議 | 多種（IP, IPX等） | 僅IP |
| 認證 | 支持 | 不支持 |
| 錯誤檢測 | CRC | CRC |

---

## 💡 實踐示例

### 交換機配置

```bash
# 查看VLAN
show vlan brief

# 查看MAC地址表
show mac address-table

# 查看STP狀態
show spanning-tree

# 查看接口狀態
show interface status
```

### VLAN測試

```bash
# 創建VLAN接口（Linux）
vconfig add eth0.10

# 分配IP地址
ifconfig eth0.10 192.168.10.1 netmask 255.255.255.0

# 發送VLAN標籤的幀
tcpdump -i eth0 vlan
```

---

## 📝 學習檢查清單

- [ ] 理解Ethernet幀格式和MTU
- [ ] 掌握MAC地址的結構和類型
- [ ] 了解VLAN的工作原理和類型
- [ ] 掌握STP協議的端口狀態和選舉過程
- [ ] 理解PPP協議的用途
- [ ] 能夠配置和管理VLAN
- [ ] 能夠排查STP相關的網路問題

---

## 🔗 相關連結

- 🔙 [[02-核心協議|返回核心協議]]
- 🌊 [[局域網(LAN)]]
- 🏷️ [[VLAN虛擬局域網]]
- 🌳 [[SDN軟體定義網絡]]
- 🛠️ [[網絡診斷工具]]
