---
title: TCP/IP協議棧
aliases:
  - TCP/IP Model
  - Internet Protocol Suite
  - TCP IP協議棧
para: resource
tags:
  - #para/resource/tech
  - #topic/networking
  - #topic/basics
  - #topic/layers
  - #protocol/tcp-ip
  - #layer/application
  - #layer/transport
  - #layer/network
  - #layer/data-link
  - #type/concept
  - #zettel/type/permanent
  - #difficulty/beginner
  - #learning/mastered
created: 2026-01-21
updated: 2026-02-15
---

> [!summary] TCP/IP协议棧概述
> TCP/IP 协议棧是網際網路的实际通訊协议套件，由四层组成，是目前广泛使用的網路通訊標準。

---

## 📊 TCP/IP 四层架構

```
┌─────────────────────────────────────────────────────────┐
│  4. 應用程式层 (Application Layer)                           │
│     HTTP, FTP, SMTP, DNS, Telnet, SSH                   │
├─────────────────────────────────────────────────────────┤
│  3. 傳輸层 (Transport Layer)                            │
│     TCP, UDP - 端到端通訊                                │
├─────────────────────────────────────────────────────────┤
│  2. 网际层 (Internet Layer)                             │
│     IP, ICMP, ARP, RARP - 路徑選擇与寻址                │
├─────────────────────────────────────────────────────────┤
│  1. 網路接口层 (Network Interface Layer)                │
│     Ethernet, Wi-Fi, PPP - 物理傳輸                     │
└─────────────────────────────────────────────────────────┘
```

---

## 🔍 各层详解

### 4️⃣ 應用程式层 (Application Layer)

**功能**：为應用程式程式提供網路服务接口

**主要协议**：

| 协议 | 端口 | 功能 | 安全版本 |
|------|------|------|----------|
| HTTP | 80 | Web瀏覽 | HTTPS (443) |
| FTP | 20/21 | 檔案傳輸 | FTPS/SFTP |
| SMTP | 25 | 電子郵件發送 | SMTPS (465) |
| POP3 | 110 | 電子郵件接收 | POP3S (995) |
| DNS | 53 | 網域名稱解析 | DNS over TLS |
| SSH | 22 | 远程登入 | - |
| Telnet | 23 | 远程登入 | ❌ 不安全 |
| DHCP | 67/68 | 動態地址分配 | - |

详见：[[應用程式层协议]]

---

### 3️⃣ 傳輸层 (Transport Layer)

**功能**：提供端到端的數據傳輸服务

#### TCP (Transmission Control Protocol)

**特點**：
- ✅ 面向連接（需要三次握手建立連接）
- ✅ 可靠傳輸（確認应答、重传機制）
- ✅ 有序傳輸（序列号）
- ✅ 流量控制（滑动視窗）
- ✅ 拥塞控制

**應用程式場景**：
- Web瀏覽 (HTTP/HTTPS)
- 檔案傳輸 (FTP)
- 電子郵件 (SMTP, POP3, IMAP)
- 远程登入 (SSH)

详见：[[TCP協議深入]]

#### UDP (User Datagram Protocol)

**特點**：
- ✅ 無連接（不需要建立連接）
- ⚠️ 不可靠傳輸
- ✅ 高效、低延遲
- ✅ 支持一对多、多对多通訊

**應用程式場景**：
- 視訊流媒体
- 線上游戏
- DNS查詢
- VoIP（语音通话）
- 实时數據傳輸

详见：[[UDP协议]]

---

### 2️⃣ 网际层 (Internet Layer)

**功能**：负责數據包的路由選擇和寻址

**主要协议**：

| 协议 | 功能 |
|------|------|
| **IP** | 网际协议，负责數據包的路由和寻址 |
| **ICMP** | 網路控制訊息协议，用于網路诊断和错误報告 |
| **ARP** | 地址解析协议，IP地址 → MAC地址 |
| **RARP** | 反向地址解析协议，MAC地址 → IP地址 |

**路由协议**：
- RIP (Routing Information Protocol) - 距离矢量
- OSPF (Open Shortest Path First) - 鏈路狀態
- BGP (Border Gateway Protocol) - 路徑矢量（網際網路核心）

详见：[[IP协议与路由]]

---

### 1️⃣ 網路接口层 (Network Interface Layer)

**功能**：處理數據在物理介质上的傳輸

**主要技術**：
- 以太网 (Ethernet)
- Wi-Fi (IEEE 802.11)
- PPP (Point-to-Point Protocol)
- 帧中继 (Frame Relay)

详见：[[Ethernet]], [[無线網路(Wi-Fi)]]

---

## 🔄 TCP/IP 數據封装過程

```
應用程式數據 (HTTP请求)
    ↓ 新增 TCP头部 (源端口、目的端口、序列号等)
TCP段
    ↓ 新增 IP头部 (源IP、目的IP、TTL等)
IP數據包
    ↓ 新增以太网头部 + 尾部 (源MAC、目的MAC、FCS等)
以太网帧
    ↓ 转换为比特流
物理信号
```

---

## 🔗 OSI vs TCP/IP 對比

```
OSI 模型                 TCP/IP 模型
┌─────────────┐          ┌─────────────┐
│ 應用程式层      │          │             │
│ 表示层      │  ←────→  │  應用程式层     │
│ 会话层      │          │             │
├─────────────┤          ├─────────────┤
│ 傳輸层      │  ←────→  │  傳輸层     │
├─────────────┤          ├─────────────┤
│ 網路层      │  ←────→  │  网际层     │
├─────────────┤          │             │
│ 數據鏈路层  │  ←────→  │ 網路接口层  │
│ 物理层      │          │             │
└─────────────┘          └─────────────┘
```

### 主要区别

| 特性 | OSI 模型 | TCP/IP 模型 |
|------|----------|-------------|
| 层数 | 7 层 | 4 层 |
| 分层方式 | 严格分层 | 相对宽松，层次边界模糊 |
| 標準化 | ISO 国际標準 | IETF 開發 |
| 理论/實踐 | 理论參考模型 | 实际實現標準 |
| 模型提出時間 | 1984 | 1974 |

### 协议对应关系

| OSI 层 | TCP/IP 层 | 对应协议 |
|--------|-----------|----------|
| 應用程式层 | 應用程式层 | HTTP, FTP, SMTP, DNS |
| 表示层 | 應用程式层 | SSL/TLS, JPEG, ASCII |
| 会话层 | 應用程式层 | RPC, SMB |
| 傳輸层 | 傳輸层 | TCP, UDP |
| 網路层 | 网际层 | IP, ICMP, ARP |
| 數據鏈路层 | 網路接口层 | Ethernet, PPP |
| 物理层 | 網路接口层 | 双绞线, 光纤, 無线电 |

---

## 💡 TCP/IP 的核心優勢

### 1. 開放性
- 协议公开，任何人都可以實現
- 促进網際網路的普及和發展

### 2. 简洁性
- 相比 OSI 模型更简单、高效

### 3. 灵活性
- 支持多种物理網路
- 支持多种應用程式层协议
- 易于擴展

### 4. 健壮性
- 分布式設計
- 故障隔离
- 自動路由恢復

---

## 🎯 關鍵概念

### 端口 (Port)
- 應用程式层进程的标识
- 16位数字 (0-65535)
- 分類：
  - 知名端口 (0-1023): 系統服务使用
  - 註冊端口 (1024-49151): 應用程式程式註冊使用
  - 動態端口 (49152-65535): 客户端临时使用

### 封装 (Encapsulation)
數據从上层向下层传递时，每一层都会新增自己的头部資訊

### 解封装 (Decapsulation)
數據从下层向上层传递时，每一层都会去除自己的头部資訊

---

## 🛠️ 實踐示例

### 示例1：访问網頁的完整流程

```
使用者輸入 URL
    ↓
DNS查詢（UDP/53）
    ↓
TCP三次握手（SYN, SYN-ACK, ACK）
    ↓
HTTP请求（TCP/80）
    ↓
伺服器處理
    ↓
HTTP響應（TCP/80）
    ↓
TCP四次挥手
    ↓
渲染頁面
```

### 示例2：數據包结构

**IP數據包**：
```
+-----------+-----------+-----------+-----------+
| 版本(4)   | IHL(4)    |    服务类型  |   总长度   |
+-----------+-----------+-----------+-----------+
|         标识符        |标志|片偏移|
+-----------+-----------+-----------+-----------+
|   TTL     |  协议     |   头部校验和           |
+-----------+-----------+-----------------------+
|             源 IP 地址 (32位)                   |
+------------------------------------------------+
|            目的 IP 地址 (32位)                 |
+------------------------------------------------+
|               选项和數據...                    |
+------------------------------------------------+
```

---

## 📝 學習檢查清單

- [ ] 能说出 TCP/IP 四层的名称和功能
- [ ] 理解 TCP 和 UDP 的区别
- [ ] 知道常见协议使用的端口号
- [ ] 能画出數據封装/解封装的過程
- [ ] 了解 OSI 模型和 TCP/IP 模型的对应关系

---

## 🔗 相關連結

- 🔙 [[01-基礎知識|返回基礎知識]]
- 📖 [[OSI七層模型]]
- 🔌 [[TCP協議深入]]
- 🌐 [[IP协议与路由]]
- 🛠️ [[06-實踐工具]]
