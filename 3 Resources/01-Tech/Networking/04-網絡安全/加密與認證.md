---
title: 加密與認證
aliases:
  - Cryptography and Authentication
  - 加密认证
para: resource
tags:
  - #para/resource/tech
  - #topic/networking
  - #topic/security
  - #topic/security/cryptography
  - #protocol/ssl-tls
  - #layer/application
  - #type/concept
  - #zettel/type/permanent
  - #difficulty/advanced
  - #learning/progress
created: 2026-02-15
updated: 2026-02-15
---

> [!summary] 加密與認證概述
> 加密技術保護數據的機密性，認證技術驗證用戶身份，是網絡安全的基礎。

---

## 📋 目錄

- [對稱加密](#對稱加密)
- [非對稱加密](#非對稱加密)
- [哈希算法](#哈希算法)
- [數字簽名](#數字簽名)
- [PKI體系](#pki體系)
- [TLS/SSL協議](#tlsssl協議)

---

## 🔑 對稱加密

### 定義

對稱加密使用相同的密鑰進行加密和解密。

### 常見算法

| 算法 | 密鑰長度 | 安全性 | 應用場景 |
|------|----------|--------|----------|
| AES | 128/192/256位 | 高 | 網際標準 |
| DES | 56位 | 低（已破解） | 已淘汰 |
| 3DES | 112/168位 | 低（已破解） | 已淘汰 |
| ChaCha20 | 256位 | 高 | 谷歌推薦 |

### AES模式

| 模式 | 特點 |
|------|------|
| ECB | 簡單，但易於模式分析 |
| CBC | 常用，需要IV |
| GCM | 支持認證加密 |
| CTR | 無需填充，支持並行 |

### 對稱加密優勢

1. **速度快**：算法效率高
2. **計算簡單**：計算複雜度低
3. **密鑰短**：密鑰較短（128-256位）

### 對稱加密劣勢

1. **密鑰分發問題**：如何安全地傳輸密鑰
2. **密鑰管理複雜**：多個對稱密鑰管理困難
3. **無不可否認性**：無法驗證發送者身份

---

## 🔐 非對稱加密

### 定義

非對稱加密使用公鑰加密，私鑰解密。

### 常見算法

| 算法 | 密鑰長度 | 安全性 | 應用場景 |
|------|----------|--------|----------|
| RSA | 2048-4096位 | 高 | 數字簽名、密鑰交換 |
| ECC | 256-521位 | 高（相同安全級更短密鑰） | 移動設備、IoT |
| ElGamal | 變長 | 高 | 理論研究 |

### 非對稱加密優勢

1. **密鑰分發簡單**：公鑰可以公開分發
2. **密鑰管理簡單**：只需保護私鑰
3. **不可否認性**：可以驗證發送者身份
4. **數字簽名**：支持數字簽名功能

### 非對稱加密劣勢

1. **速度慢**：計算複雜度高
2. **密鑰長**：需要更長的密鑰
3. **計算開銷高**：需要更多計算資源

---

## 🔢 哈希算法

### 定義

哈希算法將任意長度數據映射為固定長度的摘要。

### 常見算法

| 算法 | 輸出長度 | 安全性 | 應用場景 |
|------|----------|--------|----------|
| MD5 | 128位 | 低（已破解） | 已淘汰 |
| SHA-1 | 160位 | 低（已破解） | 已淘汰 |
| SHA-256 | 256位 | 高 | 網際標準 |
| SHA-512 | 512位 | 高 | 更高安全需求 |

### 哈希特性

1. **單向性**：從哈希值無法推算出原始數據
2. **抗碰撞性**：難以找到兩個不同數據產生相同哈希
3. **雪崩效應**：輸入微小變化導致輸出巨大變化
4. **固定輸出**：相同輸入總是產生相同輸出

### 哈希應用

- **數據完整性驗證**：對比文件哈希值
- **密碼存儲**：存儲密碼的哈希值，而非明文
- **數字簽名**：對數據生成哈希簽名
- **布隆過濾器**：快速判斷元素是否存在

---

## ✍️ 數字簽名

### 定義

數字簽名是用私鑰對數據哈希進行加密，用公鑰驗證的技術。

### 數字簽名過程

```
發送者：
原始數據 → 哈希算法 → 數據摘要 → 私鑰加密 → 數字簽名
                                                    ↓
                                            [原始數據 + 數字簽名]
                                                    ↓
接收者：
[原始數據 + 數字簽名] → 公鑰解密 → 數據摘要
原始數據 → 哈希算法 → 數據摘要（比較）
```

### 數字簽名應用

- **軟體簽名**：驗證軟體來源
- **電子郵件簽名**：確保郵件未被篡改
- **SSL證書**：網站身份驗證
- **代碼簽名**：確保代碼完整性
- **文件簽名**：確保文件完整性

---

## 🔒 PKI體系

### 定義

PKI (Public Key Infrastructure) 是管理公鑰和數字證書的基礎設施。

### PKI組成

```
┌─────────────────────────────────────────────┐
│          證書頒發機構 (CA)          │
├─────────────────────────────────────────────┤
│   註冊機構 (RA)                │
│   ├─ 證書管理系統               │
│   └─ 註冊機構                   │
└─────────────────────────────────────────────┘
              ↓ 頒發證書
┌─────────────────────────────────────────────┐
│         最終實體                     │
│   - 組織                         │
│   - 個人                         │
│   - 設備                         │
└─────────────────────────────────────────────┘
```

### X.509證書

**證書結構**：
- 版本
- 序列號
- 簽發者
- 有效期
- 主體（公鑰、主體名稱）
- 簽發者數字簽名

### 證書鏈

```
根CA證書 (自簽)
    ↓
中間CA證書
    ↓
終端實體證書
```

### CRL和OCSP

- **CRL (Certificate Revocation List)**：已吊銷證書列表
- **OCSP (Online Certificate Status Protocol)**：在線證書狀態查詢

---

## 🔐 TLS/SSL協議

### TLS協議版本

| 版本 | 說明 | 狀態 |
|------|------|------|
| SSL 2.0 | 早期版本 | 已淘汰 |
| TLS 1.0 | 不安全 | 已淘汰 |
| TLS 1.1 | 基本安全 | 已淘汰 |
| TLS 1.2 | 強加密 | 廣泛使用 |
| TLS 1.3 | 最強加密，更快速 | 新標準 |

### TLS握手過程

```
客戶端                                              伺服器
  │                                                   │
  │─── 1. ClientHello (支持的加密套件、隨機數) ──→│
  │                                                   │
  │←─ 2. ServerHello (選擇加密套件、伺服器證書、隨機數) ─│
  │←─ 3. Certificate (伺服器證書鏈)               │
  │←─ 4. ServerKeyExchange (伺服器公鑰、簽名)       │
  │←─ 5. CertificateRequest (可選，要求客戶端證書)  │
  │←─ 6. ServerHelloDone                          │
  │                                                   │
  │─── 7. Certificate (客戶端證書) ─────────────→│
  │─── 8. ClientKeyExchange (預主密鑰，伺服器公鑰加密) →│
  │─── 9. ChangeCipherSpec (通知加密開始) ──────────→│
  │─── 10. Finished (證明密鑰交換完成) ────────→│
  │                                                   │
  │←─ 11. ChangeCipherSpec ────────────────────────│
  │←─ 12. Finished ────────────────────────────────│
  │                                                   │
  └───────────── 加密通信開始 ─────────────────┘
```

### 加密套件

| 套件 | 非對稱加密 | 哈希 | 密鑰交換 |
|------|-------------|------|----------|
| TLS_RSA_WITH_AES_256_GCM_SHA384 | AES-256-GCM | SHA384 | RSA |
| TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 | AES-128-GCM | SHA256 | ECDHE-RSA |
| TLS_AES_128_GCM_SHA256 | AES-128-GCM | SHA256 | ECDHE |

### 完美前向保密 (PFS)

**定義**：即使私鑰洩漏，之前的通信仍然安全。

**PFS密鑰交換**：
- **DHE**：Diffie-Hellman Ephemeral
- **ECDHE**：Elliptic Curve Diffie-Hellman Ephemeral

---

## 📝 學習檢查清單

- [ ] 理解對稱加密和非對稱加密的區別
- [ ] 掌握常用加密算法（AES, RSA, ECC）
- [ ] 了解哈希算法的特性和應用
- [ ] 理解數字簽名的工作原理
- [ ] 了解PKI體系的組成和工作流程
- [ ] 掌握TLS/SSL協議的握手過程
- [ ] 了解PFS和密鑰交換算法

---

## 🔗 相關連結

- 🔙 [[04-網絡安全|返回網絡安全]]
- 🔐 [[網絡安全基礎]]
- 🔥 [[防火牆技術]]
- 🛡️ [[常見網絡攻擊與防禦]]
