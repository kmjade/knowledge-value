---
# æŒ‡å—
status: active
priority: high
tags: [clawdbot, plugins, development, tutorial]
aliases: [å¤–æ›é–‹ç™¼, Pluginé–‹ç™¼]
created: 2026-01-31
modified: 2026-01-31
---

# æŒ‡å—

# æŒ‡å—

## ğŸ“‹ ç›®éŒ„

- [å¤–æ›æ¦‚è¿°](#å¤–æ›æ¦‚è¿°)
- [é–‹ç™¼ç’°å¢ƒæ­å»º](#é–‹ç™¼ç’°å¢ƒæ­å»º)
- [ç¬¬ä¸€ä¸ªå¤–æ›](#ç¬¬ä¸€ä¸ªå¤–æ›)
- [å¤–æ›æ¶æ§‹](#å¤–æ›æ¶æ§‹)
- [æ ¸å¿ƒAPI](#æ ¸å¿ƒapi)
- [è¿›é˜¶åŠŸèƒ½](#è¿›é˜¶åŠŸèƒ½)
- [æ¸¬è©¦ä¸é™¤éŒ¯](#æ¸¬è©¦ä¸é™¤éŒ¯)
- [æ‰“åŒ…ä¸ç™¼ä½ˆ](#æ‰“åŒ…ä¸ç™¼ä½ˆ)
- [æœ€ä½³å¯¦è¸](#æœ€ä½³å¯¦è¸)

---

## å¤–æ›æ¦‚è¿°

### ä»€ä¹ˆæ˜¯å¤–æ›ï¼Ÿ

ClawdBot å¤–æ›æ˜¯ç‹¬ç«‹çš„ Python åŒ…ï¼Œå¯ä»¥æ“´å±•å¹³å°çš„æ ¸å¿ƒåŠŸèƒ½ã€‚æ¯ä¸ªå¤–æ›æä¾›ç‰¹å®šçš„åŠŸèƒ½ï¼Œå¦‚æ•¸æ“šæºé€£æ¥ã€æ•¸æ“šè™•ç†ã€é€šçŸ¥ç™¼é€ç­‰ã€‚

### å¤–æ›ç±»å‹

| ç±»å‹ | èªªæ˜ | ç¤ºä¾‹ |
|------|------|------|
| **æ•¸æ“šæºå¤–æ›** | é€£æ¥å¤–éƒ¨æ•¸æ“šæº | MySQL, MongoDB, API |
| **è™•ç†å™¨å¤–æ›** | è™•ç†å’Œè½¬æ¢æ•¸æ“š | æ•¸æ“šæ¸…æ´—ã€æ ¼å¼è½¬æ¢ |
| **åŠ¨ä½œå¤–æ›** | æ‰§è¡Œç‰¹å®šæ“ä½œ | ç™¼é€é›»å­éƒµä»¶ã€ä¸Šå‚³æª”æ¡ˆ |
| **æ•´åˆå¤–æ›** | æ•´åˆç¬¬ä¸‰æ–¹æœåŠ¡ | Slack, GitHub, Jira |
| **UIå¤–æ›** | æ“´å±•Webç•Œé¢ | è‡ªå®šä¹‰ä»ªè¡¨ç›˜ |

### å¤–æ›ç»“æ„

```
my-plugin/
â”œâ”€â”€ plugin/                    # å¤–æ›ä¸»åŒ…
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ core.py                # æ ¸å¿ƒé€»è¾‘
# é…ç½®
â”‚   â””â”€â”€ utils.py               # å·¥å…·å‡½æ•°
â”œâ”€â”€ tests/                     # æ¸¬è©¦æª”æ¡ˆ
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ test_core.py
â”œâ”€â”€ static/                    # é™æ€è³‡æºï¼ˆUIå¤–æ›ï¼‰
â”œâ”€â”€ templates/                 # æ¨¡æ¿æª”æ¡ˆ
â”œâ”€â”€ manifest.yaml              # å¤–æ›æ¸…å–®
â”œâ”€â”€ requirements.txt           # ä¾èµ–
â”œâ”€â”€ setup.py                   # å®‰è£è…³æœ¬
â”œâ”€â”€ README.md                  # æ–‡æª”
â””â”€â”€ LICENSE                    # è®¸å¯è¯
```

---

## é–‹ç™¼ç’°å¢ƒæ­å»º

### 1. ç’°å¢ƒè¦æ±‚

- Python 3.9+
- ClawdBot CLI
- Git

### 2. å®‰è£é–‹ç™¼å·¥å…·

```bash
# å®‰è£ ClawdBot CLI
pip install clawdbot-cli

# å®‰è£é–‹ç™¼ä¾èµ–
pip install clawdbot-dev-tools

# é©—è­‰å®‰è£
clawdbot --version
```

### 3. å‰µå»ºå¤–æ›å°ˆæ¡ˆ

```bash
# ä½¿ç”¨æ¨¡æ¿å‰µå»ºå¤–æ›
clawdbot plugin create my-awesome-plugin

# è¿›å…¥å°ˆæ¡ˆç›®éŒ„
cd my-awesome-plugin

# æŸ¥çœ‹
ls -la
```

ç”Ÿæˆçš„å°ˆæ¡ˆç»“æ„ï¼š

```
my-awesome-plugin/
# é…ç½®
â”œâ”€â”€ my_awesome_plugin/         # å¤–æ›åŒ…
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ plugin.py
â”œâ”€â”€ tests/
â”œâ”€â”€ manifest.yaml
â”œâ”€â”€ setup.py
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

### 4. æœ¬åœ°é–‹ç™¼ç’°å¢ƒ

```bash
# å‰µå»ºè™šæ‹Ÿç’°å¢ƒ
python -m venv venv

# æ¿€æ´»è™šæ‹Ÿç’°å¢ƒ
source venv/bin/activate  # Linux/Mac
# venv\Scripts\activate   # Windows

# å®‰è£ä¾èµ–
pip install -r requirements.txt

# å®‰è£å¤–æ›ï¼ˆé–‹ç™¼æ¨¡å¼ï¼‰
pip install -e .
```

---

## ç¬¬ä¸€ä¸ªå¤–æ›

### å¤–æ›æ¸…å–®ï¼ˆmanifest.yamlï¼‰

```yaml
# manifest.yaml
name: my-awesome-plugin
display_name: æˆ‘çš„è¶…æ£’å¤–æ›
version: "0.1.0"
description: ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹å¤–æ›
author: Your Name <your@email.com>
license: MIT

# å¤–æ›ç±»å‹
type: processor

# ç›¸å®¹æ€§
clawdbot:
  min_version: "2.0.0"
  max_version: "2.99.0"

# æƒé™éœ€æ±‚
permissions:
  - network: ["api.example.com"]
  - filesystem:
      read: ["./data/*"]

# é…ç½®
config_schema:
  api_key:
    type: string
    required: true
    description: APIå¯†é’¥
  timeout:
    type: integer
    default: 30
    description: è¶…æ—¶æ™‚é–“ï¼ˆç§’ï¼‰

# å…¥å£ç‚¹
entry_point: my_awesome_plugin.plugin:MyAwesomePlugin
```

### å¤–æ›ä¸»ç±»

```python
# my_awesome_plugin/plugin.py
from clawdbot.plugins import BasePlugin, PluginContext, PluginResult
from typing import Dict, Any

class MyAwesomePlugin(BasePlugin):
    """æˆ‘çš„ç¬¬ä¸€ä¸ªå¤–æ›"""

    # å¤–æ›å…ƒæ•¸æ“š
    metadata = {
        "name": "my-awesome-plugin",
        "version": "0.1.0",
        "description": "ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹å¤–æ›"
    }

    def __init__(self, config: Dict[str, Any]):
        """åˆå§‹åŒ–å¤–æ›"""
        super().__init__(config)

# é…ç½®
        self.api_key = config.get("api_key")
        self.timeout = config.get("timeout", 30)

        # åˆå§‹åŒ–å…¶ä»–è³‡æº
        self.client = None

    async def initialize(self, context: PluginContext):
        """å¤–æ›åˆå§‹åŒ–ï¼ˆå¯é€‰ï¼‰"""
        # åœ¨è¿™é‡Œæ‰§è¡Œä¸€æ¬¡æ€§åˆå§‹åŒ–æ“ä½œ
        self.logger.info("å¤–æ›åˆå§‹åŒ–ä¸­...")

        # åˆå§‹åŒ–å®¢æˆ·ç«¯
        self.client = await self.create_client()

    async def execute(
        self,
        inputs: Dict[str, Any],
        context: PluginContext
    ) -> PluginResult:
        """
        æ‰§è¡Œå¤–æ›æ ¸å¿ƒé€»è¾‘

        Args:
            inputs: è¼¸å…¥æ•¸æ“š
            context: æ‰§è¡Œä¸Šä¸‹æ–‡

        Returns:
            PluginResult: æ‰§è¡Œçµæœ
        """
        try:
            # è™•ç†è¼¸å…¥æ•¸æ“š
            processed_data = await self.process_data(inputs)

            # è¿”å›æˆåŠŸçµæœ
            return PluginResult(
                success=True,
                data=processed_data,
                message="è™•ç†æˆåŠŸ"
            )

        except Exception as e:
            # è¿”å›å¤±è´¥çµæœ
            self.logger.error(f"å¤–æ›æ‰§è¡Œå¤±è´¥: {e}")
            return PluginResult(
                success=False,
                error=str(e),
                message="è™•ç†å¤±è´¥"
            )

    async def process_data(self, data: Dict[str, Any]) -> Dict[str, Any]:
        """è™•ç†æ•¸æ“šï¼ˆç¤ºä¾‹å¯¦ç¾ï¼‰"""
        # è¿™é‡Œå¯¦ç¾ä½ çš„ä¸šåŠ¡é€»è¾‘
        result = {
            "original": data,
            "processed": f"å·²è™•ç†: {data}",
            "timestamp": self.get_current_timestamp()
        }
        return result

    async def shutdown(self, context: PluginContext):
        """å¤–æ›æ¸…ç†ï¼ˆå¯é€‰ï¼‰"""
        self.logger.info("å¤–æ›é—œé–‰ä¸­...")

        # æ¸…ç†è³‡æº
        if self.client:
            await self.client.close()

# æ–¹æ³•
    async def create_client(self):
        """å‰µå»ºå®¢æˆ·ç«¯"""
        # å¯¦ç¾å®¢æˆ·ç«¯å‰µå»ºé€»è¾‘
        return SomeAPIClient(self.api_key, timeout=self.timeout)

    def get_current_timestamp(self) -> str:
        """è·å–å½“å‰æ™‚é–“æˆ³"""
        from datetime import datetime
        return datetime.now().isoformat()
```

### æ¸¬è©¦å¤–æ›

```python
# tests/test_plugin.py
import pytest
from my_awesome_plugin.plugin import MyAwesomePlugin

@pytest.fixture
async def plugin():
    """å‰µå»ºå¤–æ›å®ä¾‹"""
    config = {
        "api_key": "test_key",
        "timeout": 10
    }
    plugin = MyAwesomePlugin(config)
    await plugin.initialize(None)
    yield plugin
    await plugin.shutdown(None)

@pytest.mark.asyncio
async def test_plugin_execute(plugin):
    """æ¸¬è©¦å¤–æ›æ‰§è¡Œ"""
    inputs = {
        "message": "Hello, World!"
    }

    result = await plugin.execute(inputs, None)

    assert result.success is True
    assert "processed" in result.data
    assert "timestamp" in result.data

@pytest.mark.asyncio
async def test_plugin_error_handling(plugin):
    """æ¸¬è©¦é”™è¯¯è™•ç†"""
    # ä¼ å…¥ç„¡æ•ˆè¼¸å…¥
    result = await plugin.execute({}, None)

    # é©—è­‰é”™è¯¯è™•ç†
    assert result.success is False
    assert result.error is not None
```

é‹è¡Œæ¸¬è©¦ï¼š

```bash
# å®‰è£æ¸¬è©¦ä¾èµ–
pip install pytest pytest-asyncio

# é‹è¡Œæ¸¬è©¦
pytest tests/

# æŸ¥çœ‹
pytest tests/ -v
```

---

## å¤–æ›æ¶æ§‹

### æ ¸å¿ƒç±»å›¾

```
BasePlugin (æŠ½è±¡åŸºç±»)
    â”‚
    â”œâ”€â”€ metadata (å…ƒæ•¸æ“š)
# é…ç½®
    â”œâ”€â”€ logger (æ—¥å¿—å™¨)
    â”‚
    â”œâ”€â”€ initialize(ctx)      # åˆå§‹åŒ–
    â”œâ”€â”€ execute(inputs, ctx) # æ‰§è¡Œ
    â””â”€â”€ shutdown(ctx)       # æ¸…ç†
           â”‚
           â–¼
    MyPlugin (ä½ çš„å¤–æ›)
```

### ç”Ÿå‘½å‘¨æœŸ

```mermaid
stateDiagram-v2
    [*] --> Loaded: åŠ è½½å¤–æ›
    Loaded --> Initialized: initialize()
    Initialized --> Ready: åˆå§‹åŒ–å®Œæˆ
    Ready --> Executing: execute()
    Executing --> Ready: æ‰§è¡Œå®Œæˆ
    Ready --> Error: æ‰§è¡Œå¤±è´¥
    Error --> Ready: é‡è¯•
    Ready --> Shutdown: shutdown()
    Shutdown --> [*]
```

### æ‰§è¡Œæµç¨‹

```
ä½¿ç”¨è€…è¯·æ±‚
    â”‚
    â–¼
é©—è­‰è¼¸å…¥
    â”‚
    â–¼
èª¿ç”¨ execute()
    â”‚
    â”œâ”€â–º è·å–æ•¸æ“š
    â”‚   â”‚
    â”‚   â–¼
    â”‚  è™•ç†æ•¸æ“š
    â”‚   â”‚
    â”‚   â–¼
    â”‚  è¿”å›çµæœ
    â”‚
    â””â”€â–º é”™è¯¯è™•ç†
        â”‚
        â–¼
    è¿”å›é”™è¯¯çµæœ
```

---

## æ ¸å¿ƒAPI

# é…ç½®

```python
class MyPlugin(BasePlugin):
    def __init__(self, config: Dict[str, Any]):
# é…ç½®
        self.api_key = config.get("api_key")
        self.timeout = config.get("timeout", 30)

        # å¸¦é»˜è®¤å€¼å’Œé©—è­‰
        self.max_retries = self.get_config(
            key="max_retries",
            default=3,
            validator=lambda x: x > 0
        )

# é…ç½®
        db_config = self.get_nested_config("database", {})

# é…ç½®
        self.validate_config(config)
```

### 2. æ—¥å¿—API

```python
class MyPlugin(BasePlugin):
    async def execute(self, inputs, context):
        # ä¸åŒçº§åˆ«çš„æ—¥å¿—
        self.logger.debug("é™¤éŒ¯è³‡è¨Š")
        self.logger.info("è™•ç†é–‹å§‹")
        self.logger.warning("è­¦å‘Šè³‡è¨Š")
        self.logger.error("é”™è¯¯è³‡è¨Š")
        self.logger.critical("ä¸¥é‡é”™è¯¯")

        # ç»“æ„åŒ–æ—¥å¿—
        self.logger.info(
            "è™•ç†å®Œæˆ",
            extra={
                "task_id": context.task_id,
                "duration": 1.5,
                "items_processed": 100
            }
        )
```

### 3. ä¸Šä¸‹æ–‡API

```python
class MyPlugin(BasePlugin):
    async def execute(self, inputs, context):
        # è·å–ä»»å‹™è³‡è¨Š
        task_id = context.task_id
        task_type = context.task_type

        # è·å–ä½¿ç”¨è€…è³‡è¨Š
        user_id = context.user_id
        user_permissions = context.permissions

        # è®¿é—®å…±äº«å„²å­˜
        shared_data = await context.get_shared_data("key")
        await context.set_shared_data("key", value)

# æ›´æ–°
        await context.send_progress(50, "æ­£åœ¨è™•ç†...")

        # ç™¼é€é€šçŸ¥
        await context.send_notification({
            "type": "info",
            "message": "è™•ç†å®Œæˆ"
        })
```

### 4. è³‡æ–™åº«API

```python
class MyPlugin(BasePlugin):
    async def execute(self, inputs, context):
        # æŸ¥è©¢æ•¸æ“š
        results = await context.db.query(
            "SELECT * FROM users WHERE id = %s",
            [user_id]
        )

        # æ’å…¥æ•¸æ“š
        await context.db.execute(
            "INSERT INTO logs (message, created_at) VALUES (%s, NOW())",
            ["Log message"]
        )

        # äº‹åŠ¡æ“ä½œ
        async with context.db.transaction() as tx:
            await tx.execute("UPDATE users SET name = %s WHERE id = %s", ["John", 1])
            await tx.execute("INSERT INTO audit (action) VALUES (%s)", ["update"])
```

### 5. ç¶²è·¯API

```python
class MyPlugin(BasePlugin):
    async def execute(self, inputs, context):
        # HTTP GET è¯·æ±‚
        response = await context.http.get(
            "https://api.example.com/data",
            headers={"Authorization": f"Bearer {self.api_key}"}
        )
        data = response.json()

        # HTTP POST è¯·æ±‚
        response = await context.http.post(
            "https://api.example.com/submit",
            json={"key": "value"}
        )

        # å¸¦é‡è¯•çš„è¯·æ±‚
        response = await context.http.get(
            "https://api.example.com/data",
            retries=3,
            backoff=2  # æŒ‡æ•°é€€é¿
        )
```

---

## è¿›é˜¶åŠŸèƒ½

### 1. å¼‚æ­¥ä»»å‹™

```python
class AsyncPlugin(BasePlugin):
    async def execute(self, inputs, context):
        # å¹¶å‘æ‰§è¡Œå¤šå€‹ä»»å‹™
        results = await asyncio.gather(
            self.fetch_data_1(),
            self.fetch_data_2(),
            self.fetch_data_3()
        )

        # ä½¿ç”¨é˜Ÿåˆ—è™•ç†å¤§é‡ä»»å‹™
        queue = asyncio.Queue()

        # ç”Ÿäº§è€…
        await self.produce_tasks(queue, inputs)

        # æ¶ˆè´¹è€…ï¼ˆå¤šå€‹workerï¼‰
        workers = [
            self.process_tasks(queue) for _ in range(5)
        ]
        await asyncio.gather(*workers)
```

### 2. æµå¼è™•ç†

```python
class StreamPlugin(BasePlugin):
    async def execute(self, inputs, context):
        # æµå¼è®€å–å¤§æª”æ¡ˆ
        async for line in self.read_stream(inputs["file_path"]):
            processed = await self.process_line(line)

# æ›´æ–°
            await context.send_progress(
                progress=0.5,
                message=f"å·²è™•ç†: {processed}"
            )

    async def read_stream(self, file_path):
        """å¼‚æ­¥è®€å–æª”æ¡ˆæµ"""
        async with aiofiles.open(file_path, 'r') as f:
            async for line in f:
                yield line.strip()
```

### 3. ç¼“å­˜æ©Ÿåˆ¶

```python
class CachedPlugin(BasePlugin):
    def __init__(self, config):
        super().__init__(config)
        self.cache_enabled = config.get("cache_enabled", True)
        self.cache_ttl = config.get("cache_ttl", 3600)

    async def execute(self, inputs, context):
        # æª¢æŸ¥ç¼“å­˜
        cache_key = self.generate_cache_key(inputs)

        if self.cache_enabled:
            cached_result = await context.cache.get(cache_key)
            if cached_result:
                self.logger.info("ä»ç¼“å­˜è¿”å›çµæœ")
                return PluginResult(success=True, data=cached_result)

        # æ‰§è¡Œå®é™…è™•ç†
        result = await self.process_data(inputs)

        # å„²å­˜åˆ°ç¼“å­˜
        if self.cache_enabled:
            await context.cache.set(cache_key, result, ttl=self.cache_ttl)

        return PluginResult(success=True, data=result)
```

### 4. é”™è¯¯é‡è¯•

```python
class RetryPlugin(BasePlugin):
    async def execute(self, inputs, context):
        max_retries = 3
        retry_delay = 1

        for attempt in range(max_retries):
            try:
                result = await self.call_external_api(inputs)
                return PluginResult(success=True, data=result)

            except TemporaryError as e:
                if attempt < max_retries - 1:
                    self.logger.warning(f"é‡è¯• {attempt + 1}/{max_retries}: {e}")
                    await asyncio.sleep(retry_delay * (2 ** attempt))  # æŒ‡æ•°é€€é¿
                else:
                    raise

        raise MaxRetriesExceeded("è¶…è¿‡æœ€å¤§é‡è¯•æ¬¡æ•°")
```

### 5. æ‰¹è™•ç†

```python
class BatchPlugin(BasePlugin):
    async def execute(self, inputs, context):
        items = inputs["items"]
        batch_size = 100

        # åˆ†æ‰¹è™•ç†
        for i in range(0, len(items), batch_size):
            batch = items[i:i + batch_size]

            # è™•ç†æ‰¹æ¬¡
            await self.process_batch(batch)

            # ç™¼é€è¿›åº¦
            progress = ((i + batch_size) / len(items)) * 100
            await context.send_progress(
                progress=min(progress, 100),
                message=f"å·²è™•ç† {min(i + batch_size, len(items))}/{len(items)} é¡¹"
            )
```

---

## æ¸¬è©¦ä¸é™¤éŒ¯

### å•å…ƒæ¸¬è©¦

```python
import pytest
from unittest.mock import AsyncMock, patch

class TestMyPlugin:
    @pytest.fixture
    def plugin_config(self):
        return {
            "api_key": "test_key",
            "timeout": 10
        }

    @pytest.fixture
    async def plugin(self, plugin_config):
        plugin = MyPlugin(plugin_config)
        await plugin.initialize(None)
        yield plugin
        await plugin.shutdown(None)

    @pytest.mark.asyncio
    async def test_success_case(self, plugin):
        inputs = {"data": "test"}
        result = await plugin.execute(inputs, None)

        assert result.success is True
        assert "processed" in result.data

    @pytest.mark.asyncio
    async def test_error_case(self, plugin):
        inputs = {}
        result = await plugin.execute(inputs, None)

        assert result.success is False

    @pytest.mark.asyncio
    @patch('my_plugin.ExternalAPI')
    async def test_external_api_call(self, mock_api, plugin):
        # Mock å¤–éƒ¨API
        mock_api.return_value.fetch_data = AsyncMock(return_value={"data": "test"})

        inputs = {"id": 123}
        result = await plugin.execute(inputs, None)

        assert result.success is True
        mock_api.assert_called_once()
```

### æ•´åˆæ¸¬è©¦

```python
@pytest.mark.integration
class TestPluginIntegration:
    async def test_full_workflow(self):
        # å‰µå»ºçœŸå®çš„ä¸Šä¸‹æ–‡
        context = await self.create_test_context()

        plugin = MyPlugin(self.config)
        await plugin.initialize(context)

        try:
            # æ‰§è¡Œå®Œæ•´æµç¨‹
            inputs = self.create_test_inputs()
            result = await plugin.execute(inputs, context)

            assert result.success is True

            # é©—è­‰è³‡æ–™åº«ç‹€æ…‹
            records = await context.db.query("SELECT * FROM results WHERE task_id = %s", [context.task_id])
            assert len(records) > 0

        finally:
            await plugin.shutdown(context)
```

### é™¤éŒ¯æŠ€å·§

```python
class DebugPlugin(BasePlugin):
    async def execute(self, inputs, context):
        # å¯ç”¨è©³ç´°æ—¥å¿—
        self.logger.setLevel(logging.DEBUG)

        # åˆ—å°é™¤éŒ¯è³‡è¨Š
        self.logger.debug(f"è¼¸å…¥: {inputs}")
# é…ç½®

        # ä½¿ç”¨ pdb é™¤éŒ¯
        import pdb; pdb.set_trace()

# åˆ†æ
        import time
        start = time.time()

        # ... æ‰§è¡Œé€»è¾‘ ...

        duration = time.time() - start
        self.logger.info(f"æ‰§è¡Œè€—æ—¶: {duration:.2f}ç§’")
```

---

## æ‰“åŒ…ä¸ç™¼ä½ˆ

### 1. æ‰“åŒ…å¤–æ›

```bash
# æ›´æ–°
# æ›´æ–°

# 2. æ§‹å»ºåˆ†å‘åŒ…
clawdbot plugin build

# è¿™å°†ç”Ÿæˆï¼š
# dist/my-awesome-plugin-1.0.0.tar.gz
# dist/my-awesome-plugin-1.0.0.whl

# 3. é©—è­‰åŒ…
clawdbot plugin validate dist/my-awesome-plugin-1.0.0.whl
```

### 2. æœ¬åœ°æ¸¬è©¦

```bash
# å®‰è£æ‰“åŒ…å¥½çš„å¤–æ›
pip install dist/my-awesome-plugin-1.0.0.whl

# åœ¨ ClawdBot ä¸­åŠ è½½å¤–æ›
clawdbot plugin install my-awesome-plugin --local

# æ¸¬è©¦å¤–æ›
clawdbot plugin test my-awesome-plugin
```

### 3. ç™¼ä½ˆåˆ°å¤–æ›å¸‚åœº

```bash
# 1. ç™»å…¥å¤–æ›å¸‚åœº
clawdbot plugin login

# 2. ç™¼ä½ˆå¤–æ›
clawdbot plugin publish dist/my-awesome-plugin-1.0.0.whl

# ç™¼ä½ˆæˆåŠŸåï¼Œä½¿ç”¨è€…å¯ä»¥è¿™æ ·å®‰è£ï¼š
# clawdbot plugin install my-awesome-plugin
```

### 4. æŒçºŒæ•´åˆ

```yaml
# .github/workflows/ci.yml
name: CI

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: Set up Python
        uses: actions/setup-python@v2
        with:
          python-version: '3.9'

      - name: Install dependencies
        run: |
          pip install -r requirements.txt
          pip install pytest pytest-asyncio

      - name: Run tests
        run: pytest tests/ -v

      - name: Build plugin
        run: clawdbot plugin build
```

---

## æœ€ä½³å¯¦è¸

### 1. ä»£ç¢¼å“è³ª

```python
# âœ… å¥½çš„å¯¦è¸
class WellStructuredPlugin(BasePlugin):
    """æ¸…æ™°çš„æ–‡æª”å­—ç¬¦ä¸²"""

    async def process_data(self, data: Dict[str, Any]) -> Dict[str, Any]:
        """
        è™•ç†è¼¸å…¥æ•¸æ“š

        Args:
            data: è¼¸å…¥æ•¸æ“šå­—å…¸

        Returns:
            è™•ç†åçš„æ•¸æ“š

        Raises:
            ValueError: å½“æ•¸æ“šæ ¼å¼ä¸æ­£ç¡®æ—¶
        """
        # å¯¦ç¾é€»è¾‘
        pass

# âŒ é¿å…çš„åšæ³•
class BadPlugin(BasePlugin):
    def process_data(self, data):  # ç¼ºå°‘ç±»å‹æ³¨è§£
        # è™•ç†æ•¸æ“š  # ç¼ºå°‘æ–‡æª”å­—ç¬¦ä¸²
        pass
```

### 2. é”™è¯¯è™•ç†

```python
class RobustPlugin(BasePlugin):
    async def execute(self, inputs, context):
        try:
            result = await self.process(inputs)

        except ValidationError as e:
            # ä¸šåŠ¡é€»è¾‘é”™è¯¯
            return PluginResult(
                success=False,
                error_code="VALIDATION_ERROR",
                message=f"è¼¸å…¥é©—è­‰å¤±è´¥: {e}"
            )

        except NetworkError as e:
            # ç¶²è·¯é”™è¯¯
            self.logger.error(f"ç¶²è·¯é”™è¯¯: {e}")
            return PluginResult(
                success=False,
                error_code="NETWORK_ERROR",
                message="ç¶²è·¯é€£æ¥å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•"
            )

        except Exception as e:
            # æœªé¢„æœŸçš„é”™è¯¯
            self.logger.exception(f"æœªçŸ¥é”™è¯¯: {e}")
            return PluginResult(
                success=False,
                error_code="INTERNAL_ERROR",
# ç®¡ç†
            )
```

### 3. æ•ˆèƒ½å„ªåŒ–

```python
class OptimizedPlugin(BasePlugin):
    # ä½¿ç”¨ç±»å˜é‡ç¼“å­˜ä¸å˜æ•¸æ“š
    STATIC_DATA = self.load_static_data()

    async def execute(self, inputs, context):
        # ä½¿ç”¨å¼‚æ­¥IO
        async with aiohttp.ClientSession() as session:
            result = await session.get(url)

        # ä½¿ç”¨ç”Ÿæˆå™¨è™•ç†å¤§æ•¸æ“š
        for item in self.process_generator(large_data):
            yield item

        # æ‰¹é‡æ“ä½œè³‡æ–™åº«
        await self.batch_insert(items, batch_size=100)
```

### 4. å®‰å…¨å¯¦è¸

```python
class SecurePlugin(BasePlugin):
    async def execute(self, inputs, context):
        # é©—è­‰è¼¸å…¥
        if not self.validate_inputs(inputs):
            raise ValidationError("ç„¡æ•ˆè¼¸å…¥")

        # æ¸…ç†æ•æ„Ÿæ•¸æ“š
        safe_inputs = self.sanitize(inputs)

        # ä½¿ç”¨å‚æ•°åŒ–æŸ¥è©¢
        await context.db.query(
            "SELECT * FROM users WHERE id = %s",
            [user_id]  # å‚æ•°åŒ–
        )

        # ä¸è¨˜éŒ„æ•æ„Ÿè³‡è¨Š
        self.logger.info(f"è™•ç†è¯·æ±‚: {task_id}")  # ä¸è¨˜éŒ„å®Œæ•´inputs
```

### 5. æ–‡æª”

```python
class DocumentedPlugin(BasePlugin):
    """
    æˆ‘çš„è¶…æ£’å¤–æ›

    é€™å€‹å¤–æ›å¯¦ç¾äº†ä»¥ä¸‹åŠŸèƒ½ï¼š
    - åŠŸèƒ½1
    - åŠŸèƒ½2
    - åŠŸèƒ½3

# é…ç½®
        api_key (str): APIå¯†é’¥
        timeout (int): è¶…æ—¶æ™‚é–“ï¼ˆç§’ï¼‰

    ç¤ºä¾‹ï¼š
        >>> plugin = MyPlugin({"api_key": "xxx"})
        >>> result = await plugin.execute({"data": "test"}, context)
    """

    def example_usage(self):
        """
        æä¾›ä½¿ç”¨ç¤ºä¾‹

        ç¤ºä¾‹ä»£ç¢¼ï¼š
        ```python
        inputs = {"key": "value"}
        result = await plugin.execute(inputs, context)
        ```
        """
        pass
```

---

## åƒè€ƒèµ„æ–™

### å®˜æ–¹æ–‡æª”
- [å¤–æ›APIæ–‡æª”](https://docs.clawdbot.dev/plugins/api)
# æŒ‡å—
- [æœ€ä½³å¯¦è¸](https://docs.clawdbot.dev/plugins/best-practices)

### ç¤ºä¾‹å¤–æ›
- [å®˜æ–¹å¤–æ›ä»“åº“](https://github.com/clawdbot/plugins)
- [ç¤¾å€å¤–æ›](https://marketplace.clawdbot.dev)

### ç›¸é—œæ–‡æª”
# æŒ‡å—
- [[å¤–æ›å®‰å…¨è¦ç¯„]] - å¤–æ›å®‰å…¨é–‹ç™¼è¦ç¯„
# æŒ‡å—

---

*å‰µå»ºæ™‚é–“: 2026-01-31*
# æ›´æ–°
*åˆ†é¡: 3 Resources*
