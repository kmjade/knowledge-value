---
title: UGV01 JSON指令集
tags:
  - para/resource/tech
  - 技术/机器人
  - 技术/通信
  - JSON
  - API
status: active
aliases:
  - UGV01指令
  - JSON指令参考
  - UGV01 API
cssclasses:
  - resource-note
created: 2026-02-19
---

# UGV01 JSON指令集

> [!info] JSON指令概述
> JSON指令是UGV01机器人与上位机交互的核心通信协议，支持通过串口、USB、HTTP、ESP-NOW等多种方式下达指令。

## 📚 JSON简介

### 什么是JSON？

JSON（JavaScript Object Notation）是一种轻量级的数据交换格式：

- ✅ 易于人阅读和编写
- ✅ 可以在多种语言之间进行数据交换
- ✅ 易于机器解析和生成
- ✅ 支持复杂数据结构

### 为什么使用JSON指令？

由于机器人驱动板的板载资源比较多、例程功能丰富、同时兼顾方便扩展上位机，所以使用JSON指令通信具有以下优势：

- **统一接口** - 所有功能通过JSON格式统一管理
- **易于扩展** - 方便添加新功能和新指令
- **语言无关** - 支持Python、C++、JavaScript等多种语言
- **灵活通信** - 支持多种通信方式
- **二次开发** - 便于基于现有框架进行二次开发

## 📡 通信方式

### 支持的通信方式

| 方式 | 特点 | 适用场景 |
|------|------|----------|
| **HTTP** | 基于Web，易于使用 | 远程控制、Web界面 |
| **串口** | 低延迟、可靠 | 上位机直连、实时控制 |
| **ESP-NOW** | 免连接、低延迟 | 多机协同、群组控制 |
| **USB** | 方便调试 | 固件更新、开发调试 |

### 心跳机制

机器人内置心跳函数：

- **超时停止** - 当3秒钟内没有新的移动控制指令下达，机器人会自动停止移动
- **安全保护** - 防止控制中断导致失控
- **持续控制** - 上位机需要定时重复下达移动指令来让机器人连续移动

## 🚗 底盘移动指令

### CMD_SPEED_CTRL - 左右轮速度控制

```json
{"T":1,"L":0.5,"R":0.5}
```

**参数说明**：
- `T` - 指令类型，固定为1
- `L` - 左侧轮速度，范围：-0.5 ~ +0.5 m/s
- `R` - 右侧轮速度，范围：-0.5 ~ +0.5 m/s

**特性**：
- 正值前进，负值后退
- 基于编码器的速度闭环控制
- 单位：m/s
- **推荐使用该指令对产品进行控制**

**示例**：
```json
{"T":1,"L":0.3,"R":0.3}     // 前进
{"T":1,"L":-0.3,"R":-0.3}   // 后退
{"T":1,"L":0.3,"R":-0.3}    // 原地右转
{"T":1,"L":-0.3,"R":0.3}    // 原地左转
{"T":1,"L":0,"R":0}         // 停止
```

---

### CMD_PWM_INPUT - 左右侧电机PWM控制

```json
{"T":11,"L":164,"R":164}
```

**参数说明**：
- `T` - 指令类型，固定为11
- `L` - 左侧电机PWM值，范围：-255 ~ +255
- `R` - 右侧电机PWM值，范围：-255 ~ +255

**特性**：
- 正值前进，负值后退
- 直接控制电机PWM
- 低速特性较差，PWM绝对值过小时电机可能不转动
- **仅用于调试使用，控制产品移动请使用CMD_SPEED_CTRL**

**示例**：
```json
{"T":11,"L":200,"R":200}     // 高速前进
{"T":11,"L":-150,"R":-150}   // 中速后退
{"T":11,"L":100,"R":-100}    // 右转
{"T":11,"L":0,"R":0}         // 停止
```

---

### CMD_ROS_CTRL - ROS控制

```json
{"T":13,"X":0.1,"Z":0.3}
```

**参数说明**：
- `T` - 指令类型，固定为13
- `X` - 移动线速度，单位：m/s
- `Z` - 转向角速度，单位：rad/s

**特性**：
- 适用于ROS系统
- 线速度和角速度控制
- 只适用于带编码器的UGV01和UGV02

**示例**：
```json
{"T":13,"X":0.2,"Z":0}       // 直线前进
{"T":13,"X":0,"Z":0.5}       // 原地旋转
{"T":13,"X":0.1,"Z":0.2}     // 前进同时右转
{"T":13,"X":0,"Z":0}         // 停止
```

---

### 设置电机PID

```json
{"T":2,"P":200,"I":2500,"D":0,"L":255}
```

**参数说明**：
- `T` - 指令类型，固定为2
- `P` - 比例系数
- `I` - 积分系数
- `D` - 微分系数
- `L` - Windup Limits（预留接口，UGV01默认PID控制器用不到）

**特性**：
- 用于调整速度闭环控制的PID参数
- 可根据实际效果调整PID系数
- 预留L参数方便更换其他PID控制器
- **不适用于带编码器的WAVE ROVER**

**示例**：
```json
{"T":2,"P":150,"I":2000,"D":10,"L":255}    // 调整PID参数
```

## 📺 OLED屏幕控制

### OLED屏幕显示内容设置

```json
{"T":3,"lineNum":0,"Text":"putYourTextHere"}
```

**参数说明**：
- `T` - 指令类型，固定为3
- `lineNum` - 行号，范围：0-3（共4行）
- `Text` - 显示内容（字符串）

**特性**：
- 每次设置一行内容
- 新内容不会影响其它行显示
- 会替换该行之前原有的内容
- 使用该指令后，OLED屏幕将不再显示机器人信息

**示例**：
```json
{"T":3,"lineNum":0,"Text":"UGV01 Robot"}      // 第1行显示标题
{"T":3,"lineNum":1,"Text":"Speed: 0.5"}     // 第2行显示速度
{"T":3,"lineNum":2,"Text":"Voltage: 12.5V"}  // 第3行显示电压
{"T":3,"lineNum":3,"Text":"Ready"}           // 第4行显示状态
```

---

### OLED屏幕恢复

```json
{"T":-3}
```

**参数说明**：
- `T` - 指令类型，固定为-3

**特性**：
- 将OLED屏幕重置为初始状态
- 恢复显示机器人默认信息（WiFi、STA模式、MAC地址、电压）

## 📊 产品信息获取

### 获取IMU数据

```json
{"T":126}
```

**参数说明**：
- `T` - 指令类型，固定为126

**返回数据**：
- 航向角
- 地磁场
- 加速度
- 姿态
- 温度

---

### CMD_BASE_FEEDBACK - 获取底盘信息反馈

```json
{"T":130}
```

**参数说明**：
- `T` - 指令类型，固定为130

**特性**：
- 一问一答方式获取底盘信息
- 包含速度、位置、姿态等信息

---

### 串口连续反馈

```json
// 关闭（默认）
{"T":131,"cmd":0}

// 开启
{"T":131,"cmd":1}
```

**参数说明**：
- `T` - 指令类型，固定为131
- `cmd` - 控制命令：0=关闭，1=开启

**特性**：
- 关闭时：通过一问一答方式获取底盘信息反馈
- 开启时：底盘会连续反馈信息，无需上位机发指令
- 适用于ROS系统
- 默认状态为关闭

---

### 串口回声开关

```json
// 关闭（默认）
{"T":143,"cmd":0}

// 开启
{"T":143,"cmd":1}
```

**参数说明**：
- `T` - 指令类型，固定为143
- `cmd` - 控制命令：0=关闭，1=开启

**特性**：
- 开启后，所有发送给下位机的指令都会出现在串口反馈中
- 便于调试和监控
- 默认状态为关闭

## 🔌 IO控制

### IO4 IO5 PWM控制

```json
{"T":132,"IO4":255,"IO5":255}
```

**参数说明**：
- `T` - 指令类型，固定为132
- `IO4` - IO4的PWM值，范围：0-255
- `IO5` - IO5的PWM值，范围：0-255

**特性**：
- 用于设置IO4和IO5的PWM输出
- 可用于控制LED亮度、舵机速度等

## 🔧 外接模块扩展

### 设置外接模块类型

```json
{"T":4,"cmd":0}
```

**参数说明**：
- `T` - 指令类型，固定为4
- `cmd` - 模块类型：0=Null，1=RoArm-M2机械臂，3=Gimbal云台

**示例**：
```json
{"T":4,"cmd":0}    // 无外接模块
{"T":4,"cmd":1}    // RoArm-M2机械臂
{"T":4,"cmd":3}    // Gimbal云台
```

---

### 云台基础控制

```json
{"T":133,"X":45,"Y":45,"SPD":0,"ACC":0}
```

**参数说明**：
- `T` - 指令类型，固定为133
- `X` - 水平角度（正值向左，负值向右）
- `Y` - 垂直角度（正值向上，负值向下）
- `SPD` - 速度（预留参数）
- `ACC` - 加速度（预留参数）

**特性**：
- 仅在产品安装有云台时有效
- 可控制云台转动到指定角度

## 📶 WiFi配置

### CMD_WIFI_APSTA - WiFi连接配置

```json
{"T":404,"ap_ssid":"UGV","ap_password":"12345678","sta_ssid":"your_ssid","sta_password":"password"}
```

**参数说明**：
- `T` - 指令类型，固定为404
- `ap_ssid` - AP热点名称
- `ap_password` - AP热点密码
- `sta_ssid` - 要连接的路由器WiFi名称
- `sta_password` - 要连接的路由器WiFi密码

**特性**：
- 配置机器人连接到已知WiFi
- 连接成功后自动保存配置
- 后续开机自动连接该WiFi
- STA模式下在OLED屏幕显示IP地址

**示例**：
```json
{"T":404,"ap_ssid":"UGV","ap_password":"12345678","sta_ssid":"MyHomeWiFi","sta_password":"wifi123"}
```

## 📡 ESP-NOW控制

### 设置ESP-NOW模式

```json
// 关闭ESP-NOW接收
{"T":301,"mode":0}

// 恢复ESP-NOW接收
{"T":301,"mode":3}
```

**参数说明**：
- `T` - 指令类型，固定为301
- `mode` - 模式：0=关闭，3=开启

**特性**：
- 新产品默认状态为开启ESP-NOW接收
- 可通过此指令关闭或恢复ESP-NOW功能
- 可将指令写入boot.mission实现开机自动设置

---

### 添加peer

```json
{"T":303,"mac":"CC:DB:A7:5C:1C:40"}
```

**参数说明**：
- `T` - 指令类型，固定为303
- `mac` - MAC地址

**特性**：
- 将MAC地址添加到peer列表
- 用于单播、组播控制
- 广播地址为"FF:FF:FF:FF:FF:FF"

---

### 删除peer

```json
{"T":304,"mac":"CC:DB:A7:5C:1C:40"}
```

**参数说明**：
- `T` - 指令类型，固定为304
- `mac` - MAC地址

**特性**：
- 从peer列表中删除指定MAC地址
- 可用于移除不再控制的设备

---

### 单播发送指令

```json
{"T":306,"mac":"CC:DB:A7:5C:1C:40","dev":0,"b":0,"s":0,"e":0,"h":0,"cmd":1,"megs":"{\"T\":114,\"led\":255}"}
```

**参数说明**：
- `T` - 指令类型，固定为306
- `mac` - 目标设备的MAC地址
- `dev` - 设备号（保留参数）
- `b`、`s`、`e`、`h` - 保留参数
- `cmd` - 命令类型
- `megs` - 要发送的JSON指令字符串

**特性**：
- 点对点控制方式
- 向指定MAC地址的设备发送指令
- 可将megs中的JSON指令替换为其它指令

---

### 组播发送指令

```json
{"T":305,"dev":0,"b":0,"s":0,"e":1.57,"h":1.57,"cmd":1,"megs":"{\"T\":114,\"led\":255}"}
```

**参数说明**：
- `T` - 指令类型，固定为305
- `dev` - 设备号（保留参数）
- `b`、`s`、`e`、`h` - 保留参数
- `cmd` - 命令类型
- `megs` - 要发送的JSON指令字符串

**特性**：
- 一对多控制方式
- 向peer列表中的所有设备发送指令
- 与广播控制的区别是可选择被控制的设备

## 🔗 相关资源

- [[UGV01学习项目]] - 当前学习项目
- [[UGV01产品介绍]] - 详细产品规格
- [[UGV01使用教程]] - 基本使用和配置指南
- [[UGV01通信方式]] - HTTP、串口、ESP-NOW通信详解

## 💡 使用建议

> [!tip] 指令选择
> - 运动控制推荐使用CMD_SPEED_CTRL（T:1）
> - 调试时可使用CMD_PWM_INPUT（T:11）
> - ROS系统使用CMD_ROS_CTRL（T:13）

> [!tip] 心跳机制
> - 记得定时发送移动指令（间隔<3秒）
> - 避免机器人因心跳超时自动停止
> - 可在程序中设置定时器自动发送

> [!tip] 调试技巧
> - 开启串口回声（T:143）查看发送的指令
> - 开启连续反馈（T:131）获取实时数据
> - 使用OLED屏幕（T:3）显示调试信息

---
**创建时间**: 2026-02-19
**最后更新**: 2026-02-19
**标签**: #para/resource/tech #技术/机器人 #技术/通信 #JSON #API
