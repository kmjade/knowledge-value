---
title: TCP/IP协议栈
aliases:
  - TCP/IP Model
  - Internet Protocol Suite
para: resource
tags:
  - 基础知识
  - TCP/IP
  - 协议栈
  - 计算机网络
created: 2026-01-21
---

> [!summary] TCP/IP协议栈概述
> TCP/IP 协议栈是互联网的实际通信协议套件，由四层组成，是目前广泛使用的网络通信标准。

---

## 📊 TCP/IP 四层架构

```
┌─────────────────────────────────────────────────────────┐
│  4. 应用层 (Application Layer)                           │
│     HTTP, FTP, SMTP, DNS, Telnet, SSH                   │
├─────────────────────────────────────────────────────────┤
│  3. 传输层 (Transport Layer)                            │
│     TCP, UDP - 端到端通信                                │
├─────────────────────────────────────────────────────────┤
│  2. 网际层 (Internet Layer)                             │
│     IP, ICMP, ARP, RARP - 路径选择与寻址                │
├─────────────────────────────────────────────────────────┤
│  1. 网络接口层 (Network Interface Layer)                │
│     Ethernet, Wi-Fi, PPP - 物理传输                     │
└─────────────────────────────────────────────────────────┘
```

---

## 🔍 各层详解

### 4️⃣ 应用层 (Application Layer)

**功能**：为应用程序提供网络服务接口

**主要协议**：
| 协议 | 端口 | 用途 | 安全版本 |
|------|------|------|----------|
| HTTP | 80 | Web浏览 | HTTPS (443) |
| FTP | 20/21 | 文件传输 | FTPS/SFTP |
| SMTP | 25 | 邮件发送 | SMTPS (465) |
| POP3 | 110 | 邮件接收 | POP3S (995) |
| IMAP | 143 | 邮件管理 | IMAPS (993) |
| DNS | 53 | 域名解析 | DNS over TLS |
| SSH | 22 | 远程登录 | - |
| Telnet | 23 | 远程登录 | ❌ 不安全 |
| DHCP | 67/68 | 动态地址分配 | - |

详见：[[应用层协议]]

---

### 3️⃣ 传输层 (Transport Layer)

**功能**：提供端到端的数据传输服务

#### TCP (Transmission Control Protocol)

**特点**：
- ✅ 面向连接（需要三次握手建立连接）
- ✅ 可靠传输（确认应答、重传机制）
- ✅ 有序传输（序列号）
- ✅ 流量控制（滑动窗口）
- ✅ 拥塞控制

**应用场景**：
- Web浏览 (HTTP/HTTPS)
- 文件传输 (FTP)
- 邮件 (SMTP, POP3, IMAP)
- 远程登录 (SSH)

详见：[[TCP协议深入]]

#### UDP (User Datagram Protocol)

**特点**：
- ✅ 无连接（不需要建立连接）
- ⚠️ 不可靠传输
- ✅ 高效、低延迟
- ✅ 支持一对多、多对多通信

**应用场景**：
- 视频流媒体
- 在线游戏
- DNS查询
- VoIP（语音通话）
- 实时数据传输

详见：[[UDP协议]]

---

### 2️⃣ 网际层 (Internet Layer)

**功能**：负责数据包的路由选择和寻址

**主要协议**：

| 协议 | 功能 |
|------|------|
| **IP** | 网际协议，负责数据包的路由和寻址 |
| **ICMP** | 网络控制消息协议，用于网络诊断和错误报告 |
| **ARP** | 地址解析协议，IP地址 → MAC地址 |
| **RARP** | 反向地址解析协议，MAC地址 → IP地址 |
| **IGMP** | 互联网组管理协议，用于组播 |

**路由协议**：
- RIP (Routing Information Protocol) - 距离矢量
- OSPF (Open Shortest Path First) - 链路状态
- BGP (Border Gateway Protocol) - 路径矢量（互联网核心）

详见：[[IP协议与路由]]

---

### 1️⃣ 网络接口层 (Network Interface Layer)

**功能**：处理数据在物理介质上的传输

**主要技术**：
- 以太网 (Ethernet)
- Wi-Fi (IEEE 802.11)
- PPP (Point-to-Point Protocol)
- 帧中继 (Frame Relay)

详见：[[Ethernet]], [[无线网络(Wi-Fi)]]

---

## 🔄 TCP/IP 数据封装过程

```
应用数据 (HTTP请求)
    ↓ 添加 TCP头部 (源端口、目的端口、序列号等)
TCP段
    ↓ 添加 IP头部 (源IP、目的IP、TTL等)
IP数据包
    ↓ 添加以太网头部 + 尾部 (源MAC、目的MAC、FCS等)
以太网帧
    ↓ 转换为比特流
物理信号
```

---

## 🔗 OSI vs TCP/IP 对比

```
OSI 模型                 TCP/IP 模型
┌─────────────┐          ┌─────────────┐
│ 应用层      │          │             │
│ 表示层      │  ←────→  │  应用层     │
│ 会话层      │          │             │
├─────────────┤          ├─────────────┤
│ 传输层      │  ←────→  │  传输层     │
├─────────────┤          ├─────────────┤
│ 网络层      │  ←────→  │  网际层     │
├─────────────┤          │             │
│ 数据链路层  │  ←────→  │ 网络接口层  │
│ 物理层      │          │             │
└─────────────┘          └─────────────┘
```

### 主要区别

| 特性 | OSI 模型 | TCP/IP 模型 |
|------|----------|-------------|
| 层数 | 7 层 | 4 层 |
| 分层方式 | 严格分层 | 相对宽松，层次边界模糊 |
| 标准化 | ISO 国际标准 | IETF 开发 |
| 理论/实践 | 理论参考模型 | 实际实现标准 |
| 模型提出时间 | 1984 | 1974 |

### 协议对应关系

| OSI 层 | TCP/IP 层 | 对应协议 |
|--------|-----------|----------|
| 应用层 | 应用层 | HTTP, FTP, SMTP, DNS |
| 表示层 | 应用层 | SSL/TLS, JPEG, ASCII |
| 会话层 | 应用层 | RPC, SMB |
| 传输层 | 传输层 | TCP, UDP |
| 网络层 | 网际层 | IP, ICMP, ARP |
| 数据链路层 | 网络接口层 | Ethernet, PPP |
| 物理层 | 网络接口层 | 双绞线, 光纤, 无线电 |

---

## 💡 TCP/IP 的核心优势

### 1. 开放性
- 协议公开，任何人都可以实现
- 促进互联网的普及和发展

### 2. 简洁性
- 相比 OSI 模型更简单
- 实现效率高

### 3. 灵活性
- 支持多种物理网络
- 支持多种应用层协议
- 易于扩展

### 4. 健壮性
- 分布式设计
- 故障隔离
- 自动路由恢复

---

## 🎯 关键概念

### 端口 (Port)
- 应用层进程的标识
- 16位数字 (0-65535)
- 分类：
  - 知名端口 (0-1023): 系统服务使用
  - 注册端口 (1024-49151): 应用程序注册使用
  - 动态端口 (49152-65535): 客户端临时使用

### 封装 (Encapsulation)
数据从上层向下层传递时，每一层都会添加自己的头部信息

### 解封装 (Decapsulation)
数据从下层向上层传递时，每一层都会去除自己的头部信息

---

## 🛠️ 实践示例

### 示例1：访问网页的完整流程

```
用户输入 URL
    ↓
DNS查询（UDP/53）
    ↓
TCP三次握手（SYN, SYN-ACK, ACK）
    ↓
HTTP请求（TCP/80）
    ↓
服务器处理
    ↓
HTTP响应（TCP/80）
    ↓
TCP四次挥手
    ↓
渲染页面
```

### 示例2：数据包结构

**IP数据包**：
```
+-----------+-----------+-----------+-----------+
| 版本(4b)  | 头部长度  | 服务类型  |   总长度   |
+-----------+-----------+-----------+-----------+
|         标识符        |标志|片偏移|
+-----------+-----------+-----------+-----------+
|   TTL     |  协议     |   头部校验和           |
+-----------+-----------+-----------------------+
|             源 IP 地址 (32位)                   |
+------------------------------------------------+
|            目的 IP 地址 (32位)                 |
+------------------------------------------------+
|               选项和数据...                    |
+------------------------------------------------+
```

---

## 📝 学习检查清单

- [ ] 能说出 TCP/IP 四层的名称和功能
- [ ] 理解 TCP 和 UDP 的区别
- [ ] 知道常见协议使用的端口号
- [ ] 能画出数据封装/解封装的过程
- [ ] 了解 OSI 模型和 TCP/IP 模型的对应关系

---

## 🔗 相关链接

- 🔙 [[01-基础知识|返回基础知识]]
- 📖 [[OSI七层模型]]
- 🔌 [[TCP协议深入]]
- 🌐 [[IP协议与路由]]
- 🛠️ [[06-实践工具]]

---

最后更新：2026-01-21
