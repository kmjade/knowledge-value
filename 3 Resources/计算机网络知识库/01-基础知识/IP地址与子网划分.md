---
title: IP地址与子网划分
aliases:
  - IP Addressing
  - Subnetting
  - CIDR
para: resource
tags:
  - 基础知识
  - IP地址
  - 子网划分
  - 计算机网络
created: 2026-01-21
---

> [!summary] IP地址概述
> IP地址是网络中设备的唯一标识符，子网划分是将一个网络划分为多个更小的子网络的技术。

---

## 📋 目录

- [IPv4地址](#ipv4地址)
- [IPv6地址](#ipv6地址)
- [子网掩码](#子网掩码)
- [子网划分](#子网划分)
- [CIDR](#cidr)
- [路由与转发](#路由与转发)

---

## 🌐 IPv4地址

### 地址格式

IPv4地址是一个32位的二进制数，通常用点分十进制表示：

```
格式: xxx.xxx.xxx.xxx (每个xxx 0-255)

示例: 192.168.1.1
二进制: 11000000.10101000.00000001.00000001
```

### 地址分类

```
┌───────────────────────────────────────────────────────────────┐
│  类别   首位二进制   首字节范围       默认子网掩码   用途      │
├───────────────────────────────────────────────────────────────┤
│   A    0xxxxxxx     1.0.0.0-126.0.0.0  255.0.0.0    大型网络  │
│   B    10xxxxxx     128.0.0.0-191.255.0.0 255.255.0.0  中型网络│
│   C    110xxxxx     192.0.0.0-223.255.255.0 255.255.255.0  小型网络│
│   D    1110xxxx     224.0.0.0-239.255.255.255  -          组播   │
│   E    1111xxxx     240.0.0.0-255.255.255.255  -          保留   │
└───────────────────────────────────────────────────────────────┘
```

**注意**：
- 0.0.0.0 表示当前网络
- 127.0.0.1 表示本地回环地址（localhost）
- 255.255.255.255 表示受限广播地址

### 特殊地址

| 地址类型 | 范围 | 说明 |
|----------|------|------|
| 私有地址 | 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 | 内网使用，不路由到公网 |
| 环回地址 | 127.0.0.0/8 | 本地测试 |
| 广播地址 | 255.255.255.255 或 x.x.x.255 | 向网段内所有主机发送 |
| 保留地址 | 169.254.0.0/16 | APIPA（自动配置失败时使用） |

---

## 🌐 IPv6地址

### 地址格式

IPv6地址是一个128位的二进制数，用冒号分隔的十六进制数表示：

```
格式: xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx

示例: 2001:0db8:85a3:0000:0000:8a2e:0370:7334
缩写: 2001:db8:85a3::8a2e:370:7334
```

### 缩写规则

1. **前导零省略**：每组的四个十六进制数字中，前导的零可以省略
   - `2001:0db8:0000:0000:0000:0000:0000:0001` → `2001:db8:0:0:0:0:0:1`

2. **连续零组压缩**：连续的一组或多组全零可以压缩为 `::`（只能压缩一次）
   - `2001:db8:0:0:0:0:0:1` → `2001:db8::1`

### 地址类型

| 类型 | 前缀 | 说明 |
|------|------|------|
| 单播 | ::1/128 | 单一目标 |
| 组播 | ff00::/8 | 一组目标 |
| 任播 | - | 任意一个目标（最近的路由器） |

### 私有地址

- `fc00::/7` - 唯一本地地址（类似于 IPv4 私有地址）
- `fe80::/10` - 链路本地地址（仅在本地链路有效）

---

## 🔢 子网掩码

### 定义

子网掩码是一个32位的二进制数，用于区分IP地址中的**网络部分**和**主机部分**。

```
网络部分连续的 1，主机部分连续的 0

示例:
IP地址: 192.168.1.10
子网掩码: 255.255.255.0 (二进制: 11111111.11111111.11111111.00000000)

网络部分: 192.168.1
主机部分: 10
```

### 默认子网掩码

| 地址类 | 默认子网掩码 | 网络位 | 主机位 |
|--------|--------------|--------|--------|
| A类 | 255.0.0.0 (/8) | 8位 | 24位 |
| B类 | 255.255.0.0 (/16) | 16位 | 16位 |
| C类 | 255.255.255.0 (/24) | 24位 | 8位 |

---

## ✂️ 子网划分

### 基本概念

子网划分是将一个网络划分成多个更小的子网络，用于：
- 优化网络性能
- 增强安全性
- 更好地管理IP地址
- 减少广播域

### 子网划分步骤

1. **确定需要划分的子网数**
2. **计算需要的子网位数**：2^n >= 子网数
3. **计算新的子网掩码**：原网络位 + 子网位数
4. **计算每个子网的范围**：
   - 子网地址：网络部分 + 子网部分 + 主机部分全0
   - 广播地址：网络部分 + 子网部分 + 主机部分全1
   - 可用主机范围：子网地址+1 ~ 广播地址-1

### 示例：将192.168.1.0/24划分为4个子网

```
原网络：192.168.1.0/24
需要子网数：4
所需位数：2 (2^2 = 4)
新子网掩码：/24 + 2 = /26 (255.255.255.192)

子网划分结果：
┌─────────────────────────────────────────────────────────┐
│ 子网    子网地址           可用IP范围             广播地址    │
├─────────────────────────────────────────────────────────┤
│ 子网1   192.168.1.0/26   192.168.1.1 - 192.168.1.62    │
│                                          192.168.1.63  │
│ 子网2   192.168.1.64/26  192.168.1.65 - 192.168.1.126   │
│                                          192.168.1.127 │
│ 子网3   192.168.1.128/26 192.168.1.129 - 192.168.1.190  │
│                                          192.168.1.191 │
│ 子网4   192.168.1.192/26 192.168.1.193 - 192.168.1.254  │
│                                          192.168.1.255 │
└─────────────────────────────────────────────────────────┘
```

### 计算公式

```
子网数 = 2^借位数
每个子网的主机数 = 2^(32 - 新子网掩码长度) - 2
可用IP数 = 每个子网的主机数
```

---

## 🎯 CIDR (无类别域间路由)

### 定义

CIDR (Classless Inter-Domain Routing) 是一种更灵活的IP地址分配方式，不限制于传统的A、B、C类划分。

### 表示方法

`IP地址/前缀长度`

示例：
- `192.168.1.0/24` - 192.168.1.0 - 192.168.1.255
- `10.0.0.0/8` - 10.0.0.0 - 10.255.255.255
- `172.16.0.0/12` - 172.16.0.0 - 172.31.255.255

### CIDR子网划分表

| CIDR | 子网掩码 | 可用主机数 | 适用场景 |
|------|----------|------------|----------|
| /8 | 255.0.0.0 | 16,777,214 | 超大型网络 |
| /16 | 255.255.0.0 | 65,534 | 大型网络 |
| /24 | 255.255.255.0 | 254 | 标准子网 |
| /25 | 255.255.255.128 | 126 | 中小子网 |
| /26 | 255.255.255.192 | 62 | 小型子网 |
| /27 | 255.255.255.224 | 30 | 小型办公室 |
| /28 | 255.255.255.240 | 14 | 小型团队 |
| /29 | 255.255.255.248 | 6 | 点对点链路 |
| /30 | 255.255.255.252 | 2 | 2台设备的链路 |

---

## 🔄 路由与转发

### 基本概念

**路由**：决定数据包从源到目的地的路径

**转发**：将数据包从接口发送出去

### 路由表

路由器根据路由表决定数据包的下一跳：

```
目标网络          子网掩码         下一跳        接口
192.168.1.0/24    255.255.255.0   192.168.1.1   eth0
10.0.0.0/8        255.0.0.0       10.0.0.1      eth1
0.0.0.0/0         0.0.0.0         192.168.1.254 eth0 (默认路由)
```

### 路由选择算法

1. **最长前缀匹配**：选择最长前缀的路由项
2. **度量值**：跳数、带宽、延迟、负载等

### 路由协议

| 协议 | 类型 | 度量值 | 适用场景 |
|------|------|--------|----------|
| RIP | 距离矢量 | 跳数（最大15） | 小型网络 |
| OSPF | 链路状态 | 成本 | 大中型网络 |
| BGP | 路径矢量 | 属性策略 | 互联网核心 |
| EIGRP | 混合 | 复合度量 | Cisco专有 |

---

## 🛠️ 实践示例

### 示例1：判断两个IP是否在同一网段

```
IP1: 192.168.1.10
IP2: 192.168.1.20
子网掩码: 255.255.255.0

计算网络部分：
IP1 AND 子网掩码 = 192.168.1.0
IP2 AND 子网掩码 = 192.168.1.0

结果：在同一网段 ✅
```

### 示例2：计算子网

```
网络: 10.0.0.0
子网掩码: /20
子网数: 8

需要位数: 3 (2^3 = 8)
新前缀: /20 + 3 = /23

子网列表:
10.0.0.0/23
10.0.2.0/23
10.0.4.0/23
10.0.6.0/23
10.0.8.0/23
10.0.10.0/23
10.0.12.0/23
10.0.14.0/23
```

---

## 💡 记忆技巧

### 二进制转十进制快速计算

```
128 64 32 16 8 4 2 1
 ✓  ✓  ✓  ✓  ✓  ✓  ✓  ✓

示例: 11000000
= 128 + 64 = 192
```

### 主机数计算

```
/24 -> 256个地址，254个可用主机
/25 -> 128个地址，126个可用主机
/26 -> 64个地址，62个可用主机
/27 -> 32个地址，30个可用主机
/28 -> 16个地址，14个可用主机
/29 -> 8个地址，6个可用主机
/30 -> 4个地址，2个可用主机
```

---

## 📝 学习检查清单

- [ ] 能说出IPv4地址的分类和范围
- [ ] 理解子网掩码的作用
- [ ] 能手动计算子网划分
- [ ] 掌握CIDR的表示方法
- [ ] 了解路由表的基本概念
- [ ] 知道常见的路由协议

---

## 🔗 相关链接

- 🔙 [[01-基础知识|返回基础知识]]
- 📖 [[OSI七层模型]]
- 🌐 [[IP协议与路由]]
- 🛠️ [[06-实践工具]]

---

最后更新：2026-01-21
